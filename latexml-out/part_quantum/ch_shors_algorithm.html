<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Chapter 25 Shor’s algorithm ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin</title>
<!--Generated on Thu Feb 20 17:33:51 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on Version: v1.6.20250220.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="up" href="./" title="Part VII Quantum Algorithms ‣ An Infinitely Large Napkin">
<link rel="up up" href="../" title="An Infinitely Large Napkin">
<link rel="start" href="../" title="An Infinitely Large Napkin">
<link rel="prev" href="ch_quantum_circuits.html" title="Chapter 24 Quantum circuits ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin">
<link rel="next" href="../part_calc/" title="Part VIII Calculus 101 ‣ An Infinitely Large Napkin">
<link rel="chapter" href="ch_quantum_states_and_measurements.html" title="Chapter 23 Quantum states and measurements ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin">
<link rel="chapter" href="ch_quantum_circuits.html" title="Chapter 24 Quantum circuits ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin">
<link rel="chapter" href="../Chx1.html" title="Preface ‣ An Infinitely Large Napkin">
<link rel="chapter" href="../Chx2.html" title="Advice for the reader ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_startout/" title="Part I Starting Out ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_absalg/" title="Part II Basic Abstract Algebra ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_basictop/" title="Part III Basic Topology ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_linalg/" title="Part IV Linear Algebra ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_groups/" title="Part V More on Groups ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_repth/" title="Part VI Representation Theory ‣ An Infinitely Large Napkin">
<link rel="part" href="./" title="Part VII Quantum Algorithms ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_calc/" title="Part VIII Calculus 101 ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_cmplxana/" title="Part IX Complex Analysis ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_measure/" title="Part X Measure Theory ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_prob/" title="Part XI Probability (TO DO) ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_diffgeo/" title="Part XII Differential Geometry ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_riemann/" title="Part XIII Riemann Surfaces ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_algnt1/" title="Part XIV Algebraic NT I: Rings of Integers ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_algnt2/" title="Part XV Algebraic NT II: Galois and Ramification Theory ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_algtop1/" title="Part XVI Algebraic Topology I: Homotopy ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_cats/" title="Part XVII Category Theory ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_algtop2/" title="Part XVIII Algebraic Topology II: Homology ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_ag1/" title="Part XIX Algebraic Geometry I: Classical Varieties ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_ag2/" title="Part XX Algebraic Geometry II: Affine Schemes ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_st1/" title="Part XXI Set Theory I: ZFC, Ordinals, and Cardinals ‣ An Infinitely Large Napkin">
<link rel="part" href="../part_st2/" title="Part XXII Set Theory II: Model Theory and Forcing ‣ An Infinitely Large Napkin">
<link rel="part" href="../Pt23/" title="Part XXIII Appendix ‣ An Infinitely Large Napkin">
</head>
<body>
<div class="ltx_page_main">
<header class="ltx_page_header">
<div class="ltx_align_center">
<a href="./" title="In An Infinitely Large Napkin" class="ltx_ref" rel="up"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VII </span>Quantum Algorithms</span></a><a href="ch_quantum_circuits.html" title="In Part VII Quantum Algorithms ‣ An Infinitely Large Napkin" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">24 </span>Quantum circuits</span></a><a href="../part_calc/" title="In An Infinitely Large Napkin" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VIII </span>Calculus 101</span></a>
</div></header>
<div class="ltx_page_content">
<section class="ltx_chapter">
<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter 25 </span>Shor’s algorithm</h1>

<div id="p1" class="ltx_para">
<p class="ltx_p">OK, now for Shor’s Algorithm:
how to factor <math id="p1.m1" class="ltx_Math" alttext="M=pq" display="inline"><mrow><mi>M</mi><mo>=</mo><mrow><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></mrow></math> in <math id="p1.m2" class="ltx_Math" alttext="O\left((\log M)^{2}\right)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow></mrow></math> time.</p>
</div>
<div id="p2" class="ltx_para">
<p class="ltx_p">This is arguably the reason agencies such as the US’s National
Security Agency have been diverting millions of dollars toward
quantum computing.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">25.1 </span>The classical (inverse) Fourier transform</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">The “crux move” in Shor’s algorithm is the so-called
quantum Fourier transform.
The Fourier transform is used to extract <em class="ltx_emph ltx_font_italic">periodicity</em> in data,
and it turns out the quantum analogue is a lot faster than the classical one.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">Let me throw the definition at you first.
Let <math id="S1.p2.m1" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math> be a positive integer, and let <math id="S1.p2.m2" class="ltx_Math" alttext="\omega_{N}=\exp\left(\frac{2\pi i}{N}\right)" display="inline"><mrow><msub><mi>ω</mi><mi>N</mi></msub><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mi>i</mi></mrow><mi>N</mi></mfrac><mo>)</mo></mrow></mrow></mrow></math>.</p>
</div>
<div id="S1.Thmtheorem1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 25.1.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S1.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p">Given a tuple of complex numbers</p>
<table id="Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex1.m1" class="ltx_Math" alttext="\left(x_{0},x_{1},\dots,x_{N-1}\right)" display="block"><mrow><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">its <span class="ltx_text ltx_font_bold" style="color:#0000FF;"> discrete inverse Fourier transform</span> is
the sequence <math id="S1.Thmtheorem1.p1.m1" class="ltx_Math" alttext="(y_{0},y_{1},\dots,y_{N-1})" display="inline"><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>y</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></math> defined by</p>
<table id="Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex2.m1" class="ltx_Math" alttext="y_{k}=\frac{1}{N}\sum_{j=0}^{N-1}\omega_{N}^{jk}x_{j}." display="block"><mrow><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>⁢</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>j</mi><mo>⁢</mo><mi>k</mi></mrow></msubsup><mo>⁢</mo><msub><mi>x</mi><mi>j</mi></msub></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Equivalently, one is applying the matrix</p>
<table id="Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex3.m1" class="ltx_Math" alttext="\frac{1}{N}\begin{bmatrix}1&amp;1&amp;1&amp;\dots&amp;1\\
1&amp;\omega_{N}&amp;\omega_{N}^{2}&amp;\dots&amp;\omega_{N}^{N-1}\\
1&amp;\omega_{N}^{2}&amp;\omega_{N}^{4}&amp;\dots&amp;\omega_{N}^{2(N-1)}\\
\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
1&amp;\omega_{N}^{N-1}&amp;\omega_{N}^{2(N-1)}&amp;\dots&amp;\omega_{N}^{(N-1)^{2}}\end{%
bmatrix}\begin{bmatrix}x_{0}\\
x_{1}\\
\vdots\\
x_{N-1}\end{bmatrix}=\begin{bmatrix}y_{0}\\
y_{1}\\
\vdots\\
y_{N-1}\end{bmatrix}." display="block"><mrow><mrow><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><msub><mi>ω</mi><mi>N</mi></msub></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mn>2</mn></msubsup></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mn>2</mn></msubsup></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mn>4</mn></msubsup></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mn>2</mn><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">⋮</mi></mtd><mtd><mi mathvariant="normal">⋮</mi></mtd><mtd><mi mathvariant="normal">⋮</mi></mtd><mtd><mi mathvariant="normal">⋱</mi></mtd><mtd><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mn>2</mn><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msubsup></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><msup><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></msubsup></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><mrow><mo>[</mo><mtable displaystyle="true" rowspacing="0pt"><mtr><mtd><msub><mi>x</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>x</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd><msub><mi>x</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>=</mo><mrow><mo>[</mo><mtable displaystyle="true" rowspacing="0pt"><mtr><mtd><msub><mi>y</mi><mn>0</mn></msub></mtd></mtr><mtr><mtd><msub><mi>y</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd><msub><mi>y</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p">The reason this operation is important is because it lets
us detect if the <math id="S1.p3.m1" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math> are periodic.
More generally, given a sequence of <math id="S1.p3.m2" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>’s appearing with period <math id="S1.p3.m3" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>,
the amplitudes will peak at inputs which are divisible by <math id="S1.p3.m4" class="ltx_Math" alttext="\frac{N}{\gcd(N,r)}" display="inline"><mfrac><mi>N</mi><mrow><mi>gcd</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></math>.
Mathematically, we have that</p>
<table id="Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex4.m1" class="ltx_Math" alttext="x_{k}=\sum_{j=0}^{N-1}y_{j}\omega_{N}^{-jk}." display="block"><mrow><mrow><msub><mi>x</mi><mi>k</mi></msub><mo rspace="0.111em">=</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>y</mi><mi>j</mi></msub><mo>⁢</mo><msubsup><mi>ω</mi><mi>N</mi><mrow><mo>−</mo><mrow><mi>j</mi><mo>⁢</mo><mi>k</mi></mrow></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S1.Thmtheorem2" class="ltx_theorem ltx_theorem_example">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" style="color:#8C0000;">Example 25.1.2</span></span><span class="ltx_text ltx_font_bold" style="color:#8C0000;"> <span class="ltx_text ltx_font_medium">(Example of discrete inverse Fourier transform)
<br class="ltx_break"></span></span>
</h6>
<div id="S1.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">Let <math id="S1.Thmtheorem2.p1.m1" class="ltx_Math" alttext="N=6" display="inline"><mrow><mi>N</mi><mo>=</mo><mn>6</mn></mrow></math>, <math id="S1.Thmtheorem2.p1.m2" class="ltx_Math" alttext="\omega=\omega_{6}=\exp(\frac{2\pi i}{6})" display="inline"><mrow><mi>ω</mi><mo>=</mo><msub><mi>ω</mi><mn>6</mn></msub><mo>=</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mfrac><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mi>i</mi></mrow><mn>6</mn></mfrac><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
and suppose <math id="S1.Thmtheorem2.p1.m3" class="ltx_Math" alttext="(x_{0},x_{1},x_{2},x_{3},x_{4},x_{5})=(0,1,0,1,0,1)" display="inline"><mrow><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>x</mi><mn>3</mn></msub><mo>,</mo><msub><mi>x</mi><mn>4</mn></msub><mo>,</mo><msub><mi>x</mi><mn>5</mn></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math>
(hence <math id="S1.Thmtheorem2.p1.m4" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math> is periodic modulo <math id="S1.Thmtheorem2.p1.m5" class="ltx_Math" alttext="2" display="inline"><mn>2</mn></math>).
Thus,</p>
<table id="A5.S3.EGx63" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex5.m1" class="ltx_Math" alttext="\displaystyle y_{0}" display="inline"><msub><mi>y</mi><mn>0</mn></msub></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex5.m2" class="ltx_Math" alttext="\displaystyle=\tfrac{1}{6}\left(\omega^{0}+\omega^{0}+\omega^{0}\right)=1/2" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>ω</mi><mn>0</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>0</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>0</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex6.m1" class="ltx_Math" alttext="\displaystyle y_{1}" display="inline"><msub><mi>y</mi><mn>1</mn></msub></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex6.m2" class="ltx_Math" alttext="\displaystyle=\tfrac{1}{6}\left(\omega^{1}+\omega^{3}+\omega^{5}\right)=0" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>ω</mi><mn>1</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>3</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>5</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex7.m1" class="ltx_Math" alttext="\displaystyle y_{2}" display="inline"><msub><mi>y</mi><mn>2</mn></msub></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex7.m2" class="ltx_Math" alttext="\displaystyle=\tfrac{1}{6}\left(\omega^{2}+\omega^{6}+\omega^{10}\right)=0" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>ω</mi><mn>2</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>6</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>10</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex8.m1" class="ltx_Math" alttext="\displaystyle y_{3}" display="inline"><msub><mi>y</mi><mn>3</mn></msub></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex8.m2" class="ltx_Math" alttext="\displaystyle=\tfrac{1}{6}\left(\omega^{3}+\omega^{9}+\omega^{15}\right)=-1/2" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>ω</mi><mn>3</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>9</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>15</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mo>−</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex9.m1" class="ltx_Math" alttext="\displaystyle y_{4}" display="inline"><msub><mi>y</mi><mn>4</mn></msub></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex9.m2" class="ltx_Math" alttext="\displaystyle=\tfrac{1}{6}\left(\omega^{4}+\omega^{12}+\omega^{20}\right)=0" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>ω</mi><mn>4</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>12</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>20</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex10.m1" class="ltx_Math" alttext="\displaystyle y_{5}" display="inline"><msub><mi>y</mi><mn>5</mn></msub></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex10.m2" class="ltx_Math" alttext="\displaystyle=\tfrac{1}{6}\left(\omega^{5}+\omega^{15}+\omega^{25}\right)=0." display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><msup><mi>ω</mi><mn>5</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>15</mn></msup><mo>+</mo><msup><mi>ω</mi><mn>25</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Thus, in the inverse transformation the “amplitudes”
are all concentrated at multiples of <math id="S1.Thmtheorem2.p1.m6" class="ltx_Math" alttext="3" display="inline"><mn>3</mn></math>;
thus this reveals the periodicity of the original
sequence by <math id="S1.Thmtheorem2.p1.m7" class="ltx_Math" alttext="\frac{N}{3}=2" display="inline"><mrow><mfrac><mi>N</mi><mn>3</mn></mfrac><mo>=</mo><mn>2</mn></mrow></math>.</p>
</div>
</div>
<div id="S1.Thmtheorem3" class="ltx_theorem ltx_theorem_remark">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#186118;">Remark 25.1.3</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#186118;"> — </span>
</h6>
<div id="S1.Thmtheorem3.p1" class="ltx_para">
<p class="ltx_p">The fact that this operation is called the “inverse”
Fourier transform is mostly a historical accident
(as my understanding goes).
Confusingly, the corresponding quantum operation is the
(not-inverted) Fourier transform.</p>
</div>
</div>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p">If we apply the definition as written, computing the transform takes <math id="S1.p4.m1" class="ltx_Math" alttext="O(N^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math> time.
It turns out that by a classical algorithm called the <span class="ltx_text ltx_font_bold" style="color:#0000FF;"> fast Fourier transform</span>
(whose details we won’t discuss, but it effectively “reuses” calculations),
one can reduce this to <math id="S1.p4.m2" class="ltx_Math" alttext="O(N\log N)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo lspace="0.167em">⁢</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><mi>N</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time.
However, for Shor’s algorithm this is also insufficient;
we need something like <math id="S1.p4.m3" class="ltx_Math" alttext="O\left((\log N)^{2}\right)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><mi>N</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow></mrow></math> instead.
This is where the quantum Fourier transform comes in.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">25.2 </span>The quantum Fourier transform</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">Note that to compute a Fourier transform, we need to multiply an <math id="S2.p1.m1" class="ltx_Math" alttext="N\times N" display="inline"><mrow><mi>N</mi><mo lspace="0.222em" rspace="0.222em">×</mo><mi>N</mi></mrow></math> matrix
with an <math id="S2.p1.m2" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math>-vector, so this takes <math id="S2.p1.m3" class="ltx_Math" alttext="O(N^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math> multiplications.
However, we are about to show that with a quantum computer,
one can do this using <math id="S2.p1.m4" class="ltx_Math" alttext="O((\log N)^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><mi>N</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math> quantum gates when <math id="S2.p1.m5" class="ltx_Math" alttext="N=2^{n}" display="inline"><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow></math>,
on a system with <math id="S2.p1.m6" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> qubits.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p">First, some more notation:</p>
</div>
<div id="S2.Thmtheorem1" class="ltx_theorem ltx_theorem_abuse">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Abuse of Notation 25.2.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S2.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p">In what follows, <math id="S2.Thmtheorem1.p1.m1" class="ltx_Math" alttext="\ket{x}" display="inline"><mrow><mo stretchy="false">|</mo><mi>x</mi><mo stretchy="false">⟩</mo></mrow></math> will refer to
<math id="S2.Thmtheorem1.p1.m2" class="ltx_Math" alttext="\ket{x_{n}}\otimes\ket{x_{n-1}}\otimes\dots\otimes\ket{x_{1}}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>n</mi></msub><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mi mathvariant="normal">⋯</mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow></mrow></math>
where <math id="S2.Thmtheorem1.p1.m3" class="ltx_Math" alttext="x=x_{n}x_{n-1}\dots x_{1}" display="inline"><mrow><mi>x</mi><mo>=</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mn>1</mn></msub></mrow></mrow></math> in binary.
For example, if <math id="S2.Thmtheorem1.p1.m4" class="ltx_Math" alttext="n=3" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow></math>
then <math id="S2.Thmtheorem1.p1.m5" class="ltx_Math" alttext="\ket{6}" display="inline"><mrow><mo stretchy="false">|</mo><mn>6</mn><mo stretchy="false">⟩</mo></mrow></math> really means <math id="S2.Thmtheorem1.p1.m6" class="ltx_Math" alttext="\ket{1}\otimes\ket{1}\otimes\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mn>1</mn><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>.
Likewise, we refer to <math id="S2.Thmtheorem1.p1.m7" class="ltx_Math" alttext="0.x_{1}x_{2}\dots x_{n}" display="inline"><mrow><mn>0</mn><mo lspace="0em" rspace="0.167em">.</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></mrow></math> as binary.</p>
</div>
</div>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">Observe that the <math id="S2.p3.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>-qubit space now has an
orthonormal basis <math id="S2.p3.m2" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math>, <math id="S2.p3.m3" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math>, …, <math id="S2.p3.m4" class="ltx_Math" alttext="\ket{N-1}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">⟩</mo></mrow></math></p>
</div>
<div id="S2.Thmtheorem2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 25.2.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S2.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">Consider an <math id="S2.Thmtheorem2.p1.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>-qubit state</p>
<table id="Ex11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex11.m1" class="ltx_Math" alttext="\ket{\psi}=\sum_{k=0}^{N-1}x_{k}\ket{k}." display="block"><mrow><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo rspace="0.111em">=</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>x</mi><mi>k</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mi>k</mi><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">The <span class="ltx_text ltx_font_bold" style="color:#0000FF;"> quantum Fourier transform</span> is defined by</p>
<table id="Ex12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex12.m1" class="ltx_Math" alttext="U_{\mathrm{QFT}}(\ket{\psi})=\frac{1}{\sqrt{N}}\sum_{j=0}^{N-1}\left(\sum_{k=0%
}^{N-1}\omega_{N}^{jk}x_{k}\right)\ket{j}." display="block"><mrow><mrow><mrow><msub><mi>U</mi><mi>QFT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><mo>⁢</mo><mrow><munderover><mo movablelimits="false" rspace="0em">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><mrow><mo>(</mo><mrow><munderover><mo lspace="0em" movablelimits="false">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>j</mi><mo>⁢</mo><mi>k</mi></mrow></msubsup><mo>⁢</mo><msub><mi>x</mi><mi>k</mi></msub></mrow></mrow><mo>)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mi>j</mi><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">In other words, using the basis <math id="S2.Thmtheorem2.p1.m2" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math>, …, <math id="S2.Thmtheorem2.p1.m3" class="ltx_Math" alttext="\ket{N-1}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">⟩</mo></mrow></math>,
<math id="S2.Thmtheorem2.p1.m4" class="ltx_Math" alttext="U_{\mathrm{QFT}}" display="inline"><msub><mi>U</mi><mi>QFT</mi></msub></math> is given by the matrix</p>
<table id="Ex13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex13.m1" class="ltx_Math" alttext="U_{\mathrm{QFT}}=\frac{1}{\sqrt{N}}\begin{bmatrix}1&amp;1&amp;1&amp;\dots&amp;1\\
1&amp;\omega_{N}&amp;\omega_{N}^{2}&amp;\dots&amp;\omega_{N}^{N-1}\\
1&amp;\omega_{N}^{2}&amp;\omega_{N}^{4}&amp;\dots&amp;\omega_{N}^{2(N-1)}\\
\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
1&amp;\omega_{N}^{N-1}&amp;\omega_{N}^{2(N-1)}&amp;\dots&amp;\omega_{N}^{(N-1)^{2}}\end{bmatrix}" display="block"><mrow><msub><mi>U</mi><mi>QFT</mi></msub><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><msub><mi>ω</mi><mi>N</mi></msub></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mn>2</mn></msubsup></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mn>2</mn></msubsup></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mn>4</mn></msubsup></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mn>2</mn><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">⋮</mi></mtd><mtd><mi mathvariant="normal">⋮</mi></mtd><mtd><mi mathvariant="normal">⋮</mi></mtd><mtd><mi mathvariant="normal">⋱</mi></mtd><mtd><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><mrow><mn>2</mn><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></msubsup></mtd><mtd><mi mathvariant="normal">…</mi></mtd><mtd><msubsup><mi>ω</mi><mi>N</mi><msup><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></msubsup></mtd></mtr></mtable><mo>]</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S2.p4" class="ltx_para">
<p class="ltx_p">This is the exactly the same definition as before,
except we have a <math id="S2.p4.m1" class="ltx_Math" alttext="\sqrt{N}" display="inline"><msqrt><mi>N</mi></msqrt></math> factor added so that <math id="S2.p4.m2" class="ltx_Math" alttext="U_{\mathrm{QFT}}" display="inline"><msub><mi>U</mi><mi>QFT</mi></msub></math> is unitary.
But the trick is that in the quantum setup, the matrix can be rewritten:</p>
</div>
<div id="S2.Thmtheorem3" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#191970;">Proposition 25.2.3</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#191970;"> <span class="ltx_text ltx_font_medium">(Tensor representation)
<br class="ltx_break"></span></span>
</h6>
<div id="S2.Thmtheorem3.p1" class="ltx_para">
<p class="ltx_p">Let <math id="S2.Thmtheorem3.p1.m1" class="ltx_Math" alttext="\ket{x}=\ket{x_{n}x_{n-1}\dots x_{1}}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>x</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo stretchy="false">⟩</mo></mrow></mrow></math>.
Then</p>
<table id="A5.S3.EGx64" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex14.m1" class="ltx_Math" alttext="\displaystyle U_{\mathrm{QFT}}(\ket{x_{n}x_{n-1}\dots x_{1}})=\frac{1}{\sqrt{N}}" display="inline"><mrow><mrow><msub><mi>U</mi><mi>QFT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac></mstyle></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex14.m2" class="ltx_math_unparsed" alttext="\displaystyle\left(\ket{0}+\exp(2\pi i\cdot 0.x_{1})\ket{1}\right)" display="inline"><mrow><mo>(</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mi>exp</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>i</mi><mo lspace="0.222em" rspace="0.222em">⋅</mo><mn>0</mn><mo lspace="0em" rspace="0.167em">.</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow><mo>)</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex15.m1" class="ltx_math_unparsed" alttext="\displaystyle\otimes\left(\ket{0}+\exp(2\pi i\cdot 0.x_{2}x_{1})\ket{1}\right)" display="inline"><mrow><mo rspace="0.222em">⊗</mo><mrow><mo>(</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mi>exp</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>i</mi><mo lspace="0.222em" rspace="0.222em">⋅</mo><mn>0</mn><mo lspace="0em" rspace="0.167em">.</mo><msub><mi>x</mi><mn>2</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow><mo>)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex16.m1" class="ltx_Math" alttext="\displaystyle\otimes\dots" display="inline"><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mi mathvariant="normal">…</mi></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex17.m1" class="ltx_math_unparsed" alttext="\displaystyle\otimes\left(\ket{0}+\exp(2\pi i\cdot 0.x_{n}\dots x_{1})\ket{1}\right)" display="inline"><mrow><mo rspace="0.222em">⊗</mo><mrow><mo>(</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mi>exp</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>i</mi><mo lspace="0.222em" rspace="0.222em">⋅</mo><mn>0</mn><mo lspace="0em" rspace="0.167em">.</mo><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">…</mi><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow><mo>)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S2.p5" class="ltx_para">
<p class="ltx_p">Direct (and quite annoying) computation.
In short, expand everything.
∎</p>
</div>
</div>
<div id="S2.p6" class="ltx_para">
<p class="ltx_p">So by using mixed states, the quantum Fourier transform
can use this “multiplication by tensor product” trick that isn’t possible classically.</p>
</div>
<div id="S2.p7" class="ltx_para">
<p class="ltx_p">Now, without further ado, here’s the circuit.
Define the rotation matrices</p>
<table id="Ex18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex18.m1" class="ltx_Math" alttext="R_{k}=\begin{bmatrix}1&amp;0\\
0&amp;\exp(2\pi i/2^{k})\end{bmatrix}." display="block"><mrow><mrow><msub><mi>R</mi><mi>k</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mi>i</mi></mrow><mo>/</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Then, for <math id="S2.p7.m1" class="ltx_Math" alttext="n=3" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow></math> the circuit is given by using controlled <math id="S2.p7.m2" class="ltx_Math" alttext="R_{k}" display="inline"><msub><mi>R</mi><mi>k</mi></msub></math>’s as follows:</p>
<table id="Ex19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex19.m1.pic1" class="ltx_picture ltx_markedasmath" height="77.64" overflow="visible" version="1.1" width="228.01"><g transform="matrix(1 0 0 -1 0 13.59)"><g transform="translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex19.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{x_{3}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex19.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 13.84 8.6 L 34.77 9.16" fill="none" stroke="#000000"></path><path class="droprule" d="M 13.56 -8.88 L 14.11 8.88" fill="none" stroke="#000000"></path><path class="droprule" d="M 13.84 -9.16 L 34.77 -8.6" fill="none" stroke="#000000"></path><path class="droprule" d="M 34.49 -8.88 L 35.04 8.88" fill="none" stroke="#000000"></path><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -0.28 L 13.84 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="#000000"></path><g transform="translate(48.6,0) translate(4.15,0) translate(0,-3.48)"><foreignObject height="11.95" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="14.49"><math id="Ex19.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{R_{2}}" display="inline"><msub><mi>R</mi><mn>2</mn></msub></math></foreignObject></g><path class="droprule" d="M 48.6 9.85 L 71.39 10.4" fill="none" stroke="#000000"></path><path class="droprule" d="M 48.33 -10.13 L 48.88 10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 48.6 -10.4 L 71.39 -9.85" fill="none" stroke="#000000"></path><path class="droprule" d="M 71.12 -10.13 L 71.67 10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 48.6 -0.28 L 48.6 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 34.77 -0.28 L 48.6 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 34.77 -0.28 L 34.77 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.69 -0.28 L 95.69 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 71.39 -0.28 L 95.69 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 71.39 -0.28 L 71.39 0.28" fill="none" stroke="#000000"></path><g transform="translate(119.99,0) translate(4.15,0) translate(0,-3.48)"><foreignObject height="11.95" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="14.49"><math id="Ex19.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{R_{3}}" display="inline"><msub><mi>R</mi><mn>3</mn></msub></math></foreignObject></g><path class="droprule" d="M 119.99 9.85 L 142.78 10.4" fill="none" stroke="#000000"></path><path class="droprule" d="M 119.72 -10.13 L 120.27 10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 119.99 -10.4 L 142.78 -9.85" fill="none" stroke="#000000"></path><path class="droprule" d="M 142.51 -10.13 L 143.06 10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 119.99 -0.28 L 119.99 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.69 -0.28 L 119.99 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.69 -0.28 L 95.69 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 168.02 -0.28 L 168.02 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 142.78 -0.28 L 168.02 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 142.78 -0.28 L 142.78 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 203.71 -0.28 L 203.71 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 168.02 -0.28 L 203.71 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 168.02 -0.28 L 168.02 0.28" fill="none" stroke="#000000"></path><g transform="translate(228.01,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.38"><math id="Ex19.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{\ket{y_{1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(0,-29.94) translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex19.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{\ket{x_{2}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 24.3 -30.22 L 24.3 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -30.22 L 24.3 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -30.22 L 0 -29.66" fill="none" stroke="#000000"></path><g transform="translate(58.31,0) translate(0,-29.94) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex19.m1.pic1.m11" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 59.72 -28.44 L 60.27 -28.44" fill="none" stroke="#000000"></path><path class="droprule" d="M 59.72 -28.44 L 60.27 -10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 59.72 -10.13 L 60.27 -10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 58.31 -30.22 L 58.31 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 24.3 -30.22 L 58.31 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 24.3 -30.22 L 24.3 -29.66" fill="none" stroke="#000000"></path><g transform="translate(85.23,0) translate(0,-29.94) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex19.m1.pic1.m12" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 85.23 -21.34 L 106.16 -20.78" fill="none" stroke="#000000"></path><path class="droprule" d="M 84.95 -38.82 L 85.51 -21.06" fill="none" stroke="#000000"></path><path class="droprule" d="M 85.23 -39.1 L 106.16 -38.54" fill="none" stroke="#000000"></path><path class="droprule" d="M 105.88 -38.82 L 106.43 -21.06" fill="none" stroke="#000000"></path><path class="droprule" d="M 85.23 -30.22 L 85.23 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 61.69 -30.22 L 85.23 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 61.69 -30.22 L 61.69 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 131.39 -30.22 L 131.39 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 106.16 -30.22 L 131.39 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 106.16 -30.22 L 106.16 -29.66" fill="none" stroke="#000000"></path><g transform="translate(156.62,0) translate(0,-29.94) translate(4.15,0) translate(0,-3.48)"><foreignObject height="11.95" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="14.49"><math id="Ex19.m1.pic1.m14" class="ltx_Math" alttext="\textstyle{R_{2}}" display="inline"><msub><mi>R</mi><mn>2</mn></msub></math></foreignObject></g><path class="droprule" d="M 156.62 -20.09 L 179.41 -19.54" fill="none" stroke="#000000"></path><path class="droprule" d="M 156.35 -40.07 L 156.9 -19.81" fill="none" stroke="#000000"></path><path class="droprule" d="M 156.62 -40.34 L 179.41 -39.79" fill="none" stroke="#000000"></path><path class="droprule" d="M 179.13 -40.07 L 179.69 -19.81" fill="none" stroke="#000000"></path><path class="droprule" d="M 156.62 -30.22 L 156.62 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 131.39 -30.22 L 156.62 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 131.39 -30.22 L 131.39 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 203.71 -30.22 L 203.71 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 179.41 -30.22 L 203.71 -29.66" fill="none" stroke="#000000"></path><path class="droprule" d="M 179.41 -30.22 L 179.41 -29.66" fill="none" stroke="#000000"></path><g transform="translate(228.01,0) translate(0,-29.94) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.38"><math id="Ex19.m1.pic1.m16" class="ltx_Math" alttext="\textstyle{\ket{y_{2}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(0,-58.63) translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex19.m1.pic1.m17" class="ltx_Math" alttext="\textstyle{\ket{x_{1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 24.3 -58.91 L 24.3 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -58.91 L 24.3 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -58.91 L 0 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 60 -58.91 L 60 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 24.3 -58.91 L 60 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 24.3 -58.91 L 24.3 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.69 -58.91 L 95.69 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 60 -58.91 L 95.69 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 60 -58.91 L 60 -58.36" fill="none" stroke="#000000"></path><g transform="translate(129.7,0) translate(0,-58.63) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex19.m1.pic1.m21" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 131.11 -57.13 L 131.67 -57.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 131.11 -57.13 L 131.67 -10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 131.11 -10.13 L 131.67 -10.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 129.7 -58.91 L 129.7 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.69 -58.91 L 129.7 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.69 -58.91 L 95.69 -58.36" fill="none" stroke="#000000"></path><g transform="translate(166.33,0) translate(0,-58.63) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex19.m1.pic1.m22" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 167.74 -57.13 L 168.29 -57.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 167.74 -57.13 L 168.29 -40.07" fill="none" stroke="#000000"></path><path class="droprule" d="M 167.74 -40.07 L 168.29 -40.07" fill="none" stroke="#000000"></path><path class="droprule" d="M 166.33 -58.91 L 166.33 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 133.08 -58.91 L 166.33 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 133.08 -58.91 L 133.08 -58.36" fill="none" stroke="#000000"></path><g transform="translate(193.25,0) translate(0,-58.63) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex19.m1.pic1.m23" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 193.25 -50.03 L 214.18 -49.48" fill="none" stroke="#000000"></path><path class="droprule" d="M 192.97 -67.51 L 193.53 -49.75" fill="none" stroke="#000000"></path><path class="droprule" d="M 193.25 -67.79 L 214.18 -67.23" fill="none" stroke="#000000"></path><path class="droprule" d="M 213.9 -67.51 L 214.45 -49.75" fill="none" stroke="#000000"></path><path class="droprule" d="M 193.25 -58.91 L 193.25 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 169.71 -58.91 L 193.25 -58.36" fill="none" stroke="#000000"></path><path class="droprule" d="M 169.71 -58.91 L 169.71 -58.36" fill="none" stroke="#000000"></path><g transform="translate(228.01,0) translate(0,-58.63) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.38"><math id="Ex19.m1.pic1.m24" class="ltx_Math" alttext="\textstyle{\ket{y_{3}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>3</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S2.Thmtheorem4" class="ltx_theorem ltx_theorem_exercise">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Exercise 25.2.4</span></span>
<br class="ltx_break">
</h6>
<div id="S2.Thmtheorem4.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text" style="font-size:90%;">Show that in this circuit, the image of <math id="S2.Thmtheorem4.p1.m1" class="ltx_Math" alttext="\ket{x_{3}x_{2}x_{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo stretchy="false">⟩</mo></mrow></math> is</span></p>
<table id="Ex20" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex20.m1" class="ltx_math_unparsed" alttext="\Big{(}\ket{0}+\exp(2\pi i\cdot 0.x_{1})\ket{1}\Big{)}\otimes\Big{(}\ket{0}+%
\exp(2\pi i\cdot 0.x_{2}x_{1})\ket{1}\Big{)}\otimes\Big{(}\ket{0}+\exp(2\pi i%
\cdot 0.x_{3}x_{2}x_{1})\ket{1}\Big{)}" display="block"><mrow><mrow><mo maxsize="160%" minsize="160%">(</mo><mrow><mo maxsize="90%" minsize="90%">|</mo><mn mathsize="90%">0</mn><mo maxsize="90%" minsize="90%">⟩</mo></mrow><mo mathsize="90%">+</mo><mi mathsize="90%">exp</mi><mrow><mo maxsize="90%" minsize="90%">(</mo><mn mathsize="90%">2</mn><mi mathsize="90%">π</mi><mi mathsize="90%">i</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em">⋅</mo><mn mathsize="90%">0</mn><mo lspace="0em" mathsize="90%" rspace="0.167em">.</mo><msub><mi mathsize="90%">x</mi><mn mathsize="90%">1</mn></msub><mo maxsize="90%" minsize="90%">)</mo></mrow><mrow><mo maxsize="90%" minsize="90%">|</mo><mn mathsize="90%">1</mn><mo maxsize="90%" minsize="90%">⟩</mo></mrow><mo maxsize="160%" minsize="160%" rspace="0.055em">)</mo></mrow><mo mathsize="90%" rspace="0.222em">⊗</mo><mrow><mo maxsize="160%" minsize="160%">(</mo><mrow><mo maxsize="90%" minsize="90%">|</mo><mn mathsize="90%">0</mn><mo maxsize="90%" minsize="90%">⟩</mo></mrow><mo mathsize="90%">+</mo><mi mathsize="90%">exp</mi><mrow><mo maxsize="90%" minsize="90%">(</mo><mn mathsize="90%">2</mn><mi mathsize="90%">π</mi><mi mathsize="90%">i</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em">⋅</mo><mn mathsize="90%">0</mn><mo lspace="0em" mathsize="90%" rspace="0.167em">.</mo><msub><mi mathsize="90%">x</mi><mn mathsize="90%">2</mn></msub><msub><mi mathsize="90%">x</mi><mn mathsize="90%">1</mn></msub><mo maxsize="90%" minsize="90%">)</mo></mrow><mrow><mo maxsize="90%" minsize="90%">|</mo><mn mathsize="90%">1</mn><mo maxsize="90%" minsize="90%">⟩</mo></mrow><mo maxsize="160%" minsize="160%" rspace="0.055em">)</mo></mrow><mo mathsize="90%" rspace="0.222em">⊗</mo><mrow><mo maxsize="160%" minsize="160%">(</mo><mrow><mo maxsize="90%" minsize="90%">|</mo><mn mathsize="90%">0</mn><mo maxsize="90%" minsize="90%">⟩</mo></mrow><mo mathsize="90%">+</mo><mi mathsize="90%">exp</mi><mrow><mo maxsize="90%" minsize="90%">(</mo><mn mathsize="90%">2</mn><mi mathsize="90%">π</mi><mi mathsize="90%">i</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em">⋅</mo><mn mathsize="90%">0</mn><mo lspace="0em" mathsize="90%" rspace="0.167em">.</mo><msub><mi mathsize="90%">x</mi><mn mathsize="90%">3</mn></msub><msub><mi mathsize="90%">x</mi><mn mathsize="90%">2</mn></msub><msub><mi mathsize="90%">x</mi><mn mathsize="90%">1</mn></msub><mo maxsize="90%" minsize="90%">)</mo></mrow><mrow><mo maxsize="90%" minsize="90%">|</mo><mn mathsize="90%">1</mn><mo maxsize="90%" minsize="90%">⟩</mo></mrow><mo maxsize="160%" minsize="160%">)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text" style="font-size:90%;">as claimed.</span></p>
</div>
</div>
<div id="S2.p8" class="ltx_para">
<p class="ltx_p">For general <math id="S2.p8.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>, we can write this as inductively as</p>
<table id="Ex21" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex21.m1.pic1" class="ltx_picture ltx_markedasmath" height="223.47" overflow="visible" version="1.1" width="353.51"><g transform="matrix(1 0 0 -1 0 15.76)"><g transform="translate(-28.7,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.78"><math id="Ex21.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{x_{n}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(6.92,0) translate(0,-3.38)"><text transform="matrix(1 0 0 -1 0 0)">         </text></g><g transform="translate(20.76,0) translate(0,-85.71) translate(0,-3.38)"><foreignObject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="40.9"><math id="Ex21.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\text{QFT}_{n-1}}" display="inline"><msub><mtext>QFT</mtext><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></foreignObject></g><path class="droprule" d="M 13.84 12.02 L 68.57 12.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 13.56 -183.72 L 14.11 12.3" fill="none" stroke="#000000"></path><path class="droprule" d="M 13.84 -184 L 68.57 -183.45" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.29 -183.72 L 68.85 12.3" fill="none" stroke="#000000"></path><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -0.28 L 13.84 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="#000000"></path><g transform="translate(82.41,0) translate(4.15,0) translate(0,-3.89)"><foreignObject height="11.12" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="15.26"><math id="Ex21.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{R_{n}}" display="inline"><msub><mi>R</mi><mi>n</mi></msub></math></foreignObject></g><path class="droprule" d="M 82.41 9.44 L 105.97 9.99" fill="none" stroke="#000000"></path><path class="droprule" d="M 82.13 -9.71 L 82.68 9.71" fill="none" stroke="#000000"></path><path class="droprule" d="M 82.41 -9.99 L 105.97 -9.44" fill="none" stroke="#000000"></path><path class="droprule" d="M 105.7 -9.71 L 106.25 9.71" fill="none" stroke="#000000"></path><path class="droprule" d="M 82.41 -0.28 L 82.41 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -0.28 L 82.41 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -0.28 L 68.57 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -0.28 L 134.82 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 105.97 -0.28 L 134.82 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 105.97 -0.28 L 105.97 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 163.67 -0.28 L 163.67 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -0.28 L 163.67 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -0.28 L 134.82 0.28" fill="none" stroke="#000000"></path><g transform="translate(177.51,0) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><path class="droprule" d="M 215.98 -0.28 L 215.98 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -0.28 L 215.98 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -0.28 L 191.35 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 240.6 -0.28 L 240.6 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.98 -0.28 L 240.6 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.98 -0.28 L 215.98 0.28" fill="none" stroke="#000000"></path><g transform="translate(254.44,0) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m11" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><path class="droprule" d="M 293.51 -0.28 L 293.51 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -0.28 L 293.51 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -0.28 L 268.28 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -0.28 L 329.21 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.51 -0.28 L 329.21 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.51 -0.28 L 293.51 0.28" fill="none" stroke="#000000"></path><g transform="translate(353.51,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.38"><math id="Ex21.m1.pic1.m15" class="ltx_Math" alttext="\textstyle{\ket{y_{1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 353.51 -0.28 L 353.51 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -0.28 L 353.51 0.28" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -0.28 L 329.21 0.28" fill="none" stroke="#000000"></path><g transform="translate(0,-34.28) translate(-35.16,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="28.24"><math id="Ex21.m1.pic1.m16" class="ltx_Math" alttext="\textstyle{\ket{x_{n-1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-34.28) translate(6.92,0) translate(0,-3.38)"><text transform="matrix(1 0 0 -1 0 0)">         </text></g><path class="droprule" d="M 13.84 -34.56 L 13.84 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -34.56 L 13.84 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -34.56 L 0 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -34.56 L 94.19 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -34.56 L 94.19 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -34.56 L 68.57 -34.01" fill="none" stroke="#000000"></path><g transform="translate(119.81,0) translate(0,-34.28) translate(4.15,0) translate(0,-3.48)"><foreignObject height="11.95" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.72"><math id="Ex21.m1.pic1.m19" class="ltx_Math" alttext="\textstyle{R_{n-1}}" display="inline"><msub><mi>R</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></foreignObject></g><path class="droprule" d="M 119.81 -24.43 L 149.83 -23.88" fill="none" stroke="#000000"></path><path class="droprule" d="M 119.53 -44.41 L 120.09 -24.16" fill="none" stroke="#000000"></path><path class="droprule" d="M 119.81 -44.69 L 149.83 -44.14" fill="none" stroke="#000000"></path><path class="droprule" d="M 149.56 -44.41 L 150.11 -24.16" fill="none" stroke="#000000"></path><path class="droprule" d="M 119.81 -34.56 L 119.81 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -34.56 L 119.81 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -34.56 L 94.19 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 163.67 -34.56 L 163.67 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 149.83 -34.56 L 163.67 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 149.83 -34.56 L 149.83 -34.01" fill="none" stroke="#000000"></path><g transform="translate(177.51,0) translate(0,-34.28) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m21" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><path class="droprule" d="M 215.98 -34.56 L 215.98 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -34.56 L 215.98 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -34.56 L 191.35 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 240.6 -34.56 L 240.6 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.98 -34.56 L 240.6 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.98 -34.56 L 215.98 -34.01" fill="none" stroke="#000000"></path><g transform="translate(254.44,0) translate(0,-34.28) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m25" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><path class="droprule" d="M 293.51 -34.56 L 293.51 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -34.56 L 293.51 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -34.56 L 268.28 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -34.56 L 329.21 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.51 -34.56 L 329.21 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.51 -34.56 L 293.51 -34.01" fill="none" stroke="#000000"></path><g transform="translate(353.51,0) translate(0,-34.28) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="20.38"><math id="Ex21.m1.pic1.m29" class="ltx_Math" alttext="\textstyle{\ket{y_{2}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 353.51 -34.56 L 353.51 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -34.56 L 353.51 -34.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -34.56 L 329.21 -34.01" fill="none" stroke="#000000"></path><g transform="translate(0,-68.57) translate(-31.13,0) translate(0,-3.46)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24.21"><math id="Ex21.m1.pic1.m30" class="ltx_Math" alttext="\textstyle{\vdots\ \ }" display="inline"><mrow><mi mathvariant="normal">⋮</mi><mspace width="1em"></mspace></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-68.57) translate(6.92,0) translate(0,-3.38)"><text transform="matrix(1 0 0 -1 0 0)">         </text></g><g transform="translate(353.51,0) translate(0,-68.57) translate(6.92,0) translate(0,-3.46)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24.21"><math id="Ex21.m1.pic1.m43" class="ltx_Math" alttext="\textstyle{\ \ \vdots}" display="inline"><mi mathvariant="normal">⋮</mi></math></foreignObject></g><g transform="translate(0,-102.85) translate(-26.72,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.8"><math id="Ex21.m1.pic1.m44" class="ltx_Math" alttext="\textstyle{\ket{x_{i}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-102.85) translate(6.92,0) translate(0,-3.38)"><text transform="matrix(1 0 0 -1 0 0)">         </text></g><path class="droprule" d="M 13.84 -103.13 L 13.84 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -103.13 L 13.84 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -103.13 L 0 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -103.13 L 94.19 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -103.13 L 94.19 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -103.13 L 68.57 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -103.13 L 134.82 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -103.13 L 134.82 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -103.13 L 94.19 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 163.67 -103.13 L 163.67 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -103.13 L 163.67 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -103.13 L 134.82 -102.58" fill="none" stroke="#000000"></path><g transform="translate(177.51,0) translate(0,-102.85) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m49" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><g transform="translate(205.18,0) translate(0,-102.85) translate(4.15,0) translate(0,-3.45)"><foreignObject height="12.01" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="13.28"><math id="Ex21.m1.pic1.m51" class="ltx_Math" alttext="\textstyle{R_{i}}" display="inline"><msub><mi>R</mi><mi>i</mi></msub></math></foreignObject></g><path class="droprule" d="M 205.18 -92.97 L 226.77 -92.42" fill="none" stroke="#000000"></path><path class="droprule" d="M 204.91 -113.01 L 205.46 -92.7" fill="none" stroke="#000000"></path><path class="droprule" d="M 205.18 -113.29 L 226.77 -112.73" fill="none" stroke="#000000"></path><path class="droprule" d="M 226.49 -113.01 L 227.04 -92.7" fill="none" stroke="#000000"></path><path class="droprule" d="M 205.18 -103.13 L 205.18 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -103.13 L 205.18 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -103.13 L 191.35 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 240.6 -103.13 L 240.6 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 226.77 -103.13 L 240.6 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 226.77 -103.13 L 226.77 -102.58" fill="none" stroke="#000000"></path><g transform="translate(254.44,0) translate(0,-102.85) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m53" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><path class="droprule" d="M 293.51 -103.13 L 293.51 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -103.13 L 293.51 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -103.13 L 268.28 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -103.13 L 329.21 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.51 -103.13 L 329.21 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.51 -103.13 L 293.51 -102.58" fill="none" stroke="#000000"></path><g transform="translate(353.51,0) translate(0,-102.85) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="36.31"><math id="Ex21.m1.pic1.m57" class="ltx_Math" alttext="\textstyle{\ket{y_{n-i+1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mrow><mrow><mi>n</mi><mo>−</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 353.51 -103.13 L 353.51 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -103.13 L 353.51 -102.58" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -103.13 L 329.21 -102.58" fill="none" stroke="#000000"></path><g transform="translate(0,-137.14) translate(-31.13,0) translate(0,-3.46)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24.21"><math id="Ex21.m1.pic1.m58" class="ltx_Math" alttext="\textstyle{\vdots\ \ }" display="inline"><mrow><mi mathvariant="normal">⋮</mi><mspace width="1em"></mspace></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-137.14) translate(6.92,0) translate(0,-3.38)"><text transform="matrix(1 0 0 -1 0 0)">         </text></g><g transform="translate(353.51,0) translate(0,-137.14) translate(6.92,0) translate(0,-3.46)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24.21"><math id="Ex21.m1.pic1.m71" class="ltx_Math" alttext="\textstyle{\ \ \vdots}" display="inline"><mi mathvariant="normal">⋮</mi></math></foreignObject></g><g transform="translate(0,-171.42) translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex21.m1.pic1.m72" class="ltx_Math" alttext="\textstyle{\ket{x_{2}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-171.42) translate(6.92,0) translate(0,-3.38)"><text transform="matrix(1 0 0 -1 0 0)">         </text></g><path class="droprule" d="M 13.84 -171.7 L 13.84 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -171.7 L 13.84 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -171.7 L 0 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -171.7 L 94.19 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -171.7 L 94.19 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 68.57 -171.7 L 68.57 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -171.7 L 134.82 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -171.7 L 134.82 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 94.19 -171.7 L 94.19 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 163.67 -171.7 L 163.67 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -171.7 L 163.67 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.82 -171.7 L 134.82 -171.15" fill="none" stroke="#000000"></path><g transform="translate(177.51,0) translate(0,-171.42) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m77" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><path class="droprule" d="M 215.98 -171.7 L 215.98 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -171.7 L 215.98 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -171.7 L 191.35 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 240.6 -171.7 L 240.6 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.98 -171.7 L 240.6 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.98 -171.7 L 215.98 -171.15" fill="none" stroke="#000000"></path><g transform="translate(254.44,0) translate(0,-171.42) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m81" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><g transform="translate(282.12,0) translate(0,-171.42) translate(4.15,0) translate(0,-3.48)"><foreignObject height="11.95" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="14.49"><math id="Ex21.m1.pic1.m83" class="ltx_Math" alttext="\textstyle{R_{2}}" display="inline"><msub><mi>R</mi><mn>2</mn></msub></math></foreignObject></g><path class="droprule" d="M 282.12 -161.57 L 304.91 -161.02" fill="none" stroke="#000000"></path><path class="droprule" d="M 281.84 -181.55 L 282.39 -161.3" fill="none" stroke="#000000"></path><path class="droprule" d="M 282.12 -181.83 L 304.91 -181.27" fill="none" stroke="#000000"></path><path class="droprule" d="M 304.63 -181.55 L 305.18 -161.3" fill="none" stroke="#000000"></path><path class="droprule" d="M 282.12 -171.7 L 282.12 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -171.7 L 282.12 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -171.7 L 268.28 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -171.7 L 329.21 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 304.91 -171.7 L 329.21 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 304.91 -171.7 L 304.91 -171.15" fill="none" stroke="#000000"></path><g transform="translate(353.51,0) translate(0,-171.42) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="27.61"><math id="Ex21.m1.pic1.m85" class="ltx_Math" alttext="\textstyle{\ket{y_{n-1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 353.51 -171.7 L 353.51 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -171.7 L 353.51 -171.15" fill="none" stroke="#000000"></path><path class="droprule" d="M 329.21 -171.7 L 329.21 -171.15" fill="none" stroke="#000000"></path><g transform="translate(0,-202.29) translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex21.m1.pic1.m86" class="ltx_Math" alttext="\textstyle{\ket{x_{1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 41.2 -202.57 L 41.2 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -202.57 L 41.2 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 0 -202.57 L 0 -202.01" fill="none" stroke="#000000"></path><g transform="translate(92.5,0) translate(0,-202.29) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex21.m1.pic1.m88" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 93.91 -200.79 L 94.47 -200.79" fill="none" stroke="#000000"></path><path class="droprule" d="M 93.91 -200.79 L 94.47 -9.71" fill="none" stroke="#000000"></path><path class="droprule" d="M 93.91 -9.71 L 94.47 -9.71" fill="none" stroke="#000000"></path><path class="droprule" d="M 92.5 -202.57 L 92.5 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 41.2 -202.57 L 92.5 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 41.2 -202.57 L 41.2 -202.01" fill="none" stroke="#000000"></path><g transform="translate(133.13,0) translate(0,-202.29) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex21.m1.pic1.m89" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 134.55 -200.79 L 135.1 -200.79" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.55 -200.79 L 135.1 -44.41" fill="none" stroke="#000000"></path><path class="droprule" d="M 134.55 -44.41 L 135.1 -44.41" fill="none" stroke="#000000"></path><path class="droprule" d="M 133.13 -202.57 L 133.13 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.88 -202.57 L 133.13 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 95.88 -202.57 L 95.88 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 163.67 -202.57 L 163.67 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 136.51 -202.57 L 163.67 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 136.51 -202.57 L 136.51 -202.01" fill="none" stroke="#000000"></path><g transform="translate(177.51,0) translate(0,-202.29) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m91" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><g transform="translate(214.28,0) translate(0,-202.29) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex21.m1.pic1.m93" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 215.7 -200.79 L 216.25 -200.79" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.7 -200.79 L 216.25 -113.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 215.7 -113.01 L 216.25 -113.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 214.28 -202.57 L 214.28 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -202.57 L 214.28 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 191.35 -202.57 L 191.35 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 240.6 -202.57 L 240.6 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 217.67 -202.57 L 240.6 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 217.67 -202.57 L 217.67 -202.01" fill="none" stroke="#000000"></path><g transform="translate(254.44,0) translate(0,-202.29) translate(-9.34,0) translate(0,-3.46) translate(4.15,0)"><foreignObject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.38"><math id="Ex21.m1.pic1.m95" class="ltx_Math" alttext="\textstyle{\cdots}" display="inline"><mi mathvariant="normal">⋯</mi></math></foreignObject></g><g transform="translate(291.82,0) translate(0,-202.29) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex21.m1.pic1.m97" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 293.23 -200.79 L 293.79 -200.79" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.23 -200.79 L 293.79 -181.55" fill="none" stroke="#000000"></path><path class="droprule" d="M 293.23 -181.55 L 293.79 -181.55" fill="none" stroke="#000000"></path><path class="droprule" d="M 291.82 -202.57 L 291.82 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -202.57 L 291.82 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 268.28 -202.57 L 268.28 -202.01" fill="none" stroke="#000000"></path><g transform="translate(318.74,0) translate(0,-202.29) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex21.m1.pic1.m98" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 318.74 -193.69 L 339.67 -193.13" fill="none" stroke="#000000"></path><path class="droprule" d="M 318.47 -211.17 L 319.02 -193.41" fill="none" stroke="#000000"></path><path class="droprule" d="M 318.74 -211.44 L 339.67 -210.89" fill="none" stroke="#000000"></path><path class="droprule" d="M 339.39 -211.17 L 339.95 -193.41" fill="none" stroke="#000000"></path><path class="droprule" d="M 318.74 -202.57 L 318.74 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 295.2 -202.57 L 318.74 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 295.2 -202.57 L 295.2 -202.01" fill="none" stroke="#000000"></path><g transform="translate(353.51,0) translate(0,-202.29) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.16"><math id="Ex21.m1.pic1.m99" class="ltx_Math" alttext="\textstyle{\ket{y_{n}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 353.51 -202.57 L 353.51 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 339.67 -202.57 L 353.51 -202.01" fill="none" stroke="#000000"></path><path class="droprule" d="M 339.67 -202.57 L 339.67 -202.01" fill="none" stroke="#000000"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S2.Thmtheorem5" class="ltx_theorem ltx_theorem_ques">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Question 25.2.5</span></span>
<br class="ltx_break">
</h6>
<div id="S2.Thmtheorem5.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text" style="font-size:90%;">Convince yourself that when <math id="S2.Thmtheorem5.p1.m1" class="ltx_Math" alttext="n=3" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow></math> the two circuits displayed are equivalent.</span></p>
</div>
</div>
<div id="S2.p9" class="ltx_para">
<p class="ltx_p">Thus, the quantum Fourier transform is achievable with <math id="S2.p9.m1" class="ltx_Math" alttext="O(n^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math> gates,
which is enormously better than the <math id="S2.p9.m2" class="ltx_Math" alttext="O(N\log N)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>N</mi><mo lspace="0.167em">⁢</mo><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><mi>N</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> operations achieved by
the classical fast Fourier transform (where <math id="S2.p9.m3" class="ltx_Math" alttext="N=2^{n}" display="inline"><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow></math>).</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">25.3 </span>Shor’s algorithm</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">The quantum Fourier transform is the key piece of Shor’s algorithm.
Now that we have it, we can solve the factoring problem.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">Let <math id="S3.p2.m1" class="ltx_Math" alttext="p,q&gt;3" display="inline"><mrow><mrow><mi>p</mi><mo>,</mo><mi>q</mi></mrow><mo>&gt;</mo><mn>3</mn></mrow></math> be odd primes, and assume <math id="S3.p2.m2" class="ltx_Math" alttext="p\neq q" display="inline"><mrow><mi>p</mi><mo>≠</mo><mi>q</mi></mrow></math>.
The main idea is to turn factoring an integer <math id="S3.p2.m3" class="ltx_Math" alttext="M=pq" display="inline"><mrow><mi>M</mi><mo>=</mo><mrow><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></mrow></math> into a problem
about finding the order of <math id="S3.p2.m4" class="ltx_Math" alttext="x\pmod{M}" display="inline"><mrow><mi>x</mi><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>; the latter is a “periodicity”
problem that the quantum Fourier transform will let us solve.
Specifically, say that an <math id="S3.p2.m5" class="ltx_Math" alttext="x\pmod{M}" display="inline"><mrow><mi>x</mi><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math> is <em class="ltx_emph ltx_font_italic">good</em> if</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(i)</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p class="ltx_p"><math id="S3.I1.i1.p1.m1" class="ltx_Math" alttext="\gcd(x,M)=1" display="inline"><mrow><mrow><mi>gcd</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>M</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>,</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(ii)</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p class="ltx_p">The order <math id="S3.I1.i2.p1.m1" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math> of <math id="S3.I1.i2.p1.m2" class="ltx_Math" alttext="x\pmod{M}" display="inline"><mrow><mi>x</mi><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math> is even, and</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(iii)</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p class="ltx_p">Factoring <math id="S3.I1.i3.p1.m1" class="ltx_Math" alttext="0\equiv(x^{r/2}-1)(x^{r/2}+1)\pmod{M}" display="inline"><mrow><mn>0</mn><mo>≡</mo><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mrow><mi>r</mi><mo>/</mo><mn>2</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mrow><mi>r</mi><mo>/</mo><mn>2</mn></mrow></msup><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>,
neither of the two factors is <math id="S3.I1.i3.p1.m2" class="ltx_Math" alttext="0\pmod{M}" display="inline"><mrow><mn>0</mn><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.
Thus one of them is divisible by <math id="S3.I1.i3.p1.m3" class="ltx_Math" alttext="p" display="inline"><mi>p</mi></math>, and the other
is divisible by <math id="S3.I1.i3.p1.m4" class="ltx_Math" alttext="q" display="inline"><mi>q</mi></math>.</p>
</div>
</li>
</ol>
</div>
<div id="S3.Thmtheorem1" class="ltx_theorem ltx_theorem_exercise">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Exercise 25.3.1</span></span><span class="ltx_text ltx_font_bold"> </span>(For contest number theory practice)
<br class="ltx_break">
</h6>
<div id="S3.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text" style="font-size:90%;">Show that for <math id="S3.Thmtheorem1.p1.m1" class="ltx_Math" alttext="M=pq" display="inline"><mrow><mi>M</mi><mo>=</mo><mrow><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></mrow></math> at least half of the residues
in <math id="S3.Thmtheorem1.p1.m2" class="ltx_Math" alttext="(\mathbb{Z}/M\mathbb{Z})^{\times}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>ℤ</mi><mo>/</mo><mi>M</mi></mrow><mo>⁢</mo><mi>ℤ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>×</mo></msup></math> are good.</span></p>
</div>
</div>
<div id="S3.p3" class="ltx_para">
<p class="ltx_p">So if we can find the order of an arbitrary <math id="S3.p3.m1" class="ltx_Math" alttext="x\in(\mathbb{Z}/M\mathbb{Z})^{\times}" display="inline"><mrow><mi>x</mi><mo>∈</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>ℤ</mi><mo>/</mo><mi>M</mi></mrow><mo>⁢</mo><mi>ℤ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>×</mo></msup></mrow></math>,
then we just keep picking <math id="S3.p3.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> until we pick a good one
(this happens more than half the time);
once we do, we compute <math id="S3.p3.m3" class="ltx_Math" alttext="\gcd(x^{r/2}-1,M)" display="inline"><mrow><mi>gcd</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mrow><mi>r</mi><mo>/</mo><mn>2</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mo>,</mo><mi>M</mi><mo stretchy="false">)</mo></mrow></mrow></math> using the Euclidean
algorithm to extract one of the prime factors of <math id="S3.p3.m4" class="ltx_Math" alttext="M" display="inline"><mi>M</mi></math>, and we’re home free.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p class="ltx_p">Now how do we do this? The idea is not so difficult:
first we generate a sequence which is periodic modulo <math id="S3.p4.m1" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>.</p>
</div>
<div id="S3.Thmtheorem2" class="ltx_theorem ltx_theorem_example">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" style="color:#8C0000;">Example 25.3.2</span></span><span class="ltx_text ltx_font_bold" style="color:#8C0000;"> <span class="ltx_text ltx_font_medium">(Factoring <math id="S3.Thmtheorem2.m1" class="ltx_Math" alttext="77" display="inline"><mn mathcolor="#8C0000">77</mn></math>: generating the periodic state)
<br class="ltx_break"></span></span>
</h6>
<div id="S3.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">Let’s say we’re trying to factor <math id="S3.Thmtheorem2.p1.m1" class="ltx_Math" alttext="M=77" display="inline"><mrow><mi>M</mi><mo>=</mo><mn>77</mn></mrow></math>,
and we randomly select <math id="S3.Thmtheorem2.p1.m2" class="ltx_Math" alttext="x=2" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>2</mn></mrow></math>, and want to find its order <math id="S3.Thmtheorem2.p1.m3" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>.
Let <math id="S3.Thmtheorem2.p1.m4" class="ltx_Math" alttext="n=13" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>13</mn></mrow></math> and <math id="S3.Thmtheorem2.p1.m5" class="ltx_Math" alttext="N=2^{13}" display="inline"><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mn>13</mn></msup></mrow></math>, and start by initializing the state</p>
<table id="Ex22" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex22.m1" class="ltx_Math" alttext="\ket{\psi}=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}\ket{k}." display="block"><mrow><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><mo>⁢</mo><mrow><munderover><mo movablelimits="false" rspace="0em">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy="false">|</mo><mi>k</mi><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Now, build a circuit <math id="S3.Thmtheorem2.p1.m6" class="ltx_Math" alttext="U_{x}" display="inline"><msub><mi>U</mi><mi>x</mi></msub></math> (depending on <math id="S3.Thmtheorem2.p1.m7" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>)
which takes <math id="S3.Thmtheorem2.p1.m8" class="ltx_Math" alttext="\ket{k}\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>k</mi><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math> to <math id="S3.Thmtheorem2.p1.m9" class="ltx_Math" alttext="\ket{k}\ket{x^{k}\bmod M}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>k</mi><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mrow><msup><mi>x</mi><mi>k</mi></msup><mo>mod</mo><mi>M</mi></mrow><mo stretchy="false">⟩</mo></mrow></mrow></math>.
Applying this to <math id="S3.Thmtheorem2.p1.m10" class="ltx_Math" alttext="\ket{\psi}\otimes\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math> gives</p>
<table id="Ex23" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex23.m1" class="ltx_Math" alttext="U(\ket{\psi}\ket{0})=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}\ket{k}\otimes\ket{x^{k%
}\bmod M}." display="block"><mrow><mrow><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><mo>⁢</mo><mrow><munderover><mo movablelimits="false" rspace="0em">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><mrow><mo stretchy="false">|</mo><mi>k</mi><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mrow><msup><mi>x</mi><mi>k</mi></msup><mo>mod</mo><mi>M</mi></mrow><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Now suppose we measure the second qubit, and get a state of <math id="S3.Thmtheorem2.p1.m11" class="ltx_Math" alttext="\ket{128}" display="inline"><mrow><mo stretchy="false">|</mo><mn>128</mn><mo stretchy="false">⟩</mo></mrow></math>.
That tells us that the collapsed state now, up to scaling, is</p>
<table id="Ex24" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex24.m1" class="ltx_Math" alttext="(\ket{7}+\ket{7+r}+\ket{7+2r}+\dots)\otimes\ket{128}." display="block"><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>7</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mrow><mn>7</mn><mo>+</mo><mi>r</mi></mrow><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mrow><mn>7</mn><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>r</mi></mrow></mrow><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mi mathvariant="normal">…</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>128</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S3.p5" class="ltx_para">
<p class="ltx_p">The bottleneck is actually the circuit <math id="S3.p5.m1" class="ltx_Math" alttext="U_{x}" display="inline"><msub><mi>U</mi><mi>x</mi></msub></math>;
one can compute <math id="S3.p5.m2" class="ltx_Math" alttext="x^{k}\pmod{M}" display="inline"><mrow><msup><mi>x</mi><mi>k</mi></msup><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mi>M</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math> by using repeated squaring,
but it’s still the clumsy part of the whole operation.</p>
</div>
<div id="S3.p6" class="ltx_para">
<p class="ltx_p">In general, the operation is:</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p class="ltx_p">Pick a sufficiently large <math id="S3.I2.i1.p1.m1" class="ltx_Math" alttext="N=2^{n}" display="inline"><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow></math> (say, <math id="S3.I2.i1.p1.m2" class="ltx_Math" alttext="N\geq M^{2}" display="inline"><mrow><mi>N</mi><mo>≥</mo><msup><mi>M</mi><mn>2</mn></msup></mrow></math>).</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p class="ltx_p">Generate <math id="S3.I2.i2.p1.m1" class="ltx_Math" alttext="\ket{\psi}=\sum_{k=0}^{2^{n}-1}\ket{k}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo rspace="0.111em">=</mo><mrow><msubsup><mo rspace="0em">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="false">|</mo><mi>k</mi><mo stretchy="false">⟩</mo></mrow></mrow></mrow></math>.</p>
</div>
</li>
<li id="S3.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i3.p1" class="ltx_para">
<p class="ltx_p">Build a circuit <math id="S3.I2.i3.p1.m1" class="ltx_Math" alttext="U_{x}" display="inline"><msub><mi>U</mi><mi>x</mi></msub></math> which computes <math id="S3.I2.i3.p1.m2" class="ltx_Math" alttext="\ket{x^{k}\mod M}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><msup><mi>x</mi><mi>k</mi></msup><mo>mod</mo><mi>M</mi></mrow><mo stretchy="false">⟩</mo></mrow></math>.</p>
</div>
</li>
<li id="S3.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i4.p1" class="ltx_para">
<p class="ltx_p">Apply it to get a state
<math id="S3.I2.i4.p1.m1" class="ltx_Math" alttext="\frac{1}{\sqrt{N}}\sum_{k=0}^{2^{n}-1}\ket{k}\otimes\ket{x^{k}\mod M}" display="inline"><mrow><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><mo>⁢</mo><mrow><msubsup><mo rspace="0em">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mrow><mo stretchy="false">|</mo><mi>k</mi><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mrow><msup><mi>x</mi><mi>k</mi></msup><mo>mod</mo><mi>M</mi></mrow><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow></math>.</p>
</div>
</li>
<li id="S3.I2.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i5.p1" class="ltx_para">
<p class="ltx_p">Measure the second qubit to cause the first qubit to
collapse to something which is periodic modulo <math id="S3.I2.i5.p1.m1" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>.
Let <math id="S3.I2.i5.p1.m2" class="ltx_Math" alttext="\ket{\phi}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ϕ</mi><mo stretchy="false">⟩</mo></mrow></math> denote the left qubit.</p>
</div>
</li>
</ul>
</div>
<div id="S3.p7" class="ltx_para">
<p class="ltx_p">Suppose we apply the quantum Fourier transform to the left qubit <math id="S3.p7.m1" class="ltx_Math" alttext="\ket{\phi}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ϕ</mi><mo stretchy="false">⟩</mo></mrow></math> now:
since the left bit is periodic modulo <math id="S3.p7.m2" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>, we expect the transform
will tell us what <math id="S3.p7.m3" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math> is.
Unfortunately, this doesn’t quite work out, since <math id="S3.p7.m4" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math> is a power of two,
but we don’t expect <math id="S3.p7.m5" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math> to be.</p>
</div>
<div id="S3.p8" class="ltx_para">
<p class="ltx_p">Nevertheless, consider a state</p>
<table id="Ex25" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex25.m1" class="ltx_Math" alttext="\ket{\phi}=\ket{k_{0}}+\ket{k_{0}+r}+\dots" display="block"><mrow><mrow><mo stretchy="false">|</mo><mi>ϕ</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><mi>r</mi></mrow><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mi mathvariant="normal">…</mi></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">so for example previously we had <math id="S3.p8.m1" class="ltx_Math" alttext="k_{0}=7" display="inline"><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><mn>7</mn></mrow></math> if we measured <math id="S3.p8.m2" class="ltx_Math" alttext="128" display="inline"><mn>128</mn></math> on <math id="S3.p8.m3" class="ltx_Math" alttext="x=2" display="inline"><mrow><mi>x</mi><mo>=</mo><mn>2</mn></mrow></math>.
Applying the quantum Fourier transform, we see that the
coefficient of <math id="S3.p8.m4" class="ltx_Math" alttext="\ket{j}" display="inline"><mrow><mo stretchy="false">|</mo><mi>j</mi><mo stretchy="false">⟩</mo></mrow></math> in the transformed image is equal to</p>
<table id="Ex26" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex26.m1" class="ltx_Math" alttext="\omega_{N}^{k_{0}j}\cdot\left(\omega_{N}^{0}+\omega_{N}^{jr}+\omega_{N}^{2jr}+%
\omega_{N}^{3jr}+\dots\right)" display="block"><mrow><msubsup><mi>ω</mi><mi>N</mi><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>⁢</mo><mi>j</mi></mrow></msubsup><mo lspace="0.222em" rspace="0.222em">⋅</mo><mrow><mo>(</mo><mrow><msubsup><mi>ω</mi><mi>N</mi><mn>0</mn></msubsup><mo>+</mo><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>j</mi><mo>⁢</mo><mi>r</mi></mrow></msubsup><mo>+</mo><msubsup><mi>ω</mi><mi>N</mi><mrow><mn>2</mn><mo>⁢</mo><mi>j</mi><mo>⁢</mo><mi>r</mi></mrow></msubsup><mo>+</mo><msubsup><mi>ω</mi><mi>N</mi><mrow><mn>3</mn><mo>⁢</mo><mi>j</mi><mo>⁢</mo><mi>r</mi></mrow></msubsup><mo>+</mo><mi mathvariant="normal">…</mi></mrow><mo>)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">As this is a sum of roots of unity, we realize we have
destructive interference unless <math id="S3.p8.m5" class="ltx_Math" alttext="\omega_{N}^{jr}=1" display="inline"><mrow><msubsup><mi>ω</mi><mi>N</mi><mrow><mi>j</mi><mo>⁢</mo><mi>r</mi></mrow></msubsup><mo>=</mo><mn>1</mn></mrow></math> (since <math id="S3.p8.m6" class="ltx_Math" alttext="N" display="inline"><mi>N</mi></math> is large).
In other words, we approximately have</p>
<table id="Ex27" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex27.m1" class="ltx_Math" alttext="U_{\mathrm{QFT}}(\ket{\phi})\approx\sum_{\begin{subarray}{c}0\leq j&lt;N\\
jr/N\in\mathbb{Z}\end{subarray}}\ket{j}" display="block"><mrow><mrow><msub><mi>U</mi><mi>QFT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mi>ϕ</mi><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">≈</mo><mrow><munder><mo movablelimits="false" rspace="0em">∑</mo><mtable rowspacing="0pt"><mtr><mtd><mrow><mn>0</mn><mo>≤</mo><mi>j</mi><mo>&lt;</mo><mi>N</mi></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi>j</mi><mo>⁢</mo><mi>r</mi></mrow><mo>/</mo><mi>N</mi></mrow><mo>∈</mo><mi>ℤ</mi></mrow></mtd></mtr></mtable></munder><mrow><mo stretchy="false">|</mo><mi>j</mi><mo stretchy="false">⟩</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">up to scaling as usual.
The bottom line is that</p>
</div>
<div id="S3.Thmtheorem3" class="ltx_theorem ltx_theorem_moral">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#186118;">Moral 25.3.3</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:#186118;"> — </span>
</h6>
<div id="S3.Thmtheorem3.p1" class="ltx_para">
<p class="ltx_p">If we measure <math id="S3.Thmtheorem3.p1.m1" class="ltx_Math" alttext="U_{\mathrm{QFT}}\ket{\phi}" display="inline"><mrow><msub><mi>U</mi><mi>QFT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mi>ϕ</mi><mo stretchy="false">⟩</mo></mrow></mrow></math> we obtain a <math id="S3.Thmtheorem3.p1.m2" class="ltx_Math" alttext="\ket{j}" display="inline"><mrow><mo stretchy="false">|</mo><mi>j</mi><mo stretchy="false">⟩</mo></mrow></math> such that
<math id="S3.Thmtheorem3.p1.m3" class="ltx_Math" alttext="\frac{jr}{N}" display="inline"><mfrac><mrow><mi>j</mi><mo>⁢</mo><mi>r</mi></mrow><mi>N</mi></mfrac></math> is close to an <math id="S3.Thmtheorem3.p1.m4" class="ltx_Math" alttext="s\in\mathbb{Z}" display="inline"><mrow><mi>s</mi><mo>∈</mo><mi>ℤ</mi></mrow></math>.</p>
</div>
</div>
<div id="S3.p9" class="ltx_para">
<p class="ltx_p">And thus given sufficient luck we can use continued fractions
to extract the value of <math id="S3.p9.m1" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>.</p>
</div>
<div id="S3.Thmtheorem4" class="ltx_theorem ltx_theorem_example">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" style="color:#8C0000;">Example 25.3.4</span></span><span class="ltx_text ltx_font_bold" style="color:#8C0000;"> <span class="ltx_text ltx_font_medium">(Finishing the factoring of <math id="S3.Thmtheorem4.m1" class="ltx_Math" alttext="M=77" display="inline"><mrow><mi mathcolor="#8C0000">M</mi><mo mathcolor="#8C0000">=</mo><mn mathcolor="#8C0000">77</mn></mrow></math>)
<br class="ltx_break"></span></span>
</h6>
<div id="S3.Thmtheorem4.p1" class="ltx_para">
<p class="ltx_p">As before, we made an observation to the second qubit,
and thus the first qubit collapses to the state
<math id="S3.Thmtheorem4.p1.m1" class="ltx_Math" alttext="\ket{\phi}=\ket{7}+\ket{7+r}+\dots" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>ϕ</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">|</mo><mn>7</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mrow><mn>7</mn><mo>+</mo><mi>r</mi></mrow><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mi mathvariant="normal">…</mi></mrow></mrow></math>.
Now we make a measurement and obtain <math id="S3.Thmtheorem4.p1.m2" class="ltx_Math" alttext="j=4642" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>4642</mn></mrow></math>, which means that
for some integer <math id="S3.Thmtheorem4.p1.m3" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> we have</p>
<table id="Ex28" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex28.m1" class="ltx_Math" alttext="\frac{4642r}{2^{13}}\approx s." display="block"><mrow><mrow><mfrac><mrow><mn>4642</mn><mo>⁢</mo><mi>r</mi></mrow><msup><mn>2</mn><mn>13</mn></msup></mfrac><mo>≈</mo><mi>s</mi></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">Now, we analyze the continued fraction of <math id="S3.Thmtheorem4.p1.m4" class="ltx_Math" alttext="\frac{4642}{2^{13}}" display="inline"><mfrac><mn>4642</mn><msup><mn>2</mn><mn>13</mn></msup></mfrac></math>;
we find the first few convergents are</p>
<table id="Ex29" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex29.m1" class="ltx_Math" alttext="0,\;1,\;\frac{1}{2},\;\frac{4}{7},\;\frac{13}{23},\;\frac{17}{30},\;\frac{1152%
}{2033},\;\dots" display="block"><mrow><mn>0</mn><mo>,</mo><mn> 1</mn><mo rspace="0.447em">,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo rspace="0.447em">,</mo><mfrac><mn>4</mn><mn>7</mn></mfrac><mo rspace="0.447em">,</mo><mfrac><mn>13</mn><mn>23</mn></mfrac><mo rspace="0.447em">,</mo><mfrac><mn>17</mn><mn>30</mn></mfrac><mo rspace="0.447em">,</mo><mfrac><mn>1152</mn><mn>2033</mn></mfrac><mo rspace="0.447em">,</mo><mi mathvariant="normal">…</mi></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">So <math id="S3.Thmtheorem4.p1.m5" class="ltx_Math" alttext="\frac{17}{30}" display="inline"><mfrac><mn>17</mn><mn>30</mn></mfrac></math> is a good approximation,
hence we deduce <math id="S3.Thmtheorem4.p1.m6" class="ltx_Math" alttext="s=17" display="inline"><mrow><mi>s</mi><mo>=</mo><mn>17</mn></mrow></math> and <math id="S3.Thmtheorem4.p1.m7" class="ltx_Math" alttext="r=30" display="inline"><mrow><mi>r</mi><mo>=</mo><mn>30</mn></mrow></math> as candidates.
And indeed, one can check that <math id="S3.Thmtheorem4.p1.m8" class="ltx_Math" alttext="r=30" display="inline"><mrow><mi>r</mi><mo>=</mo><mn>30</mn></mrow></math> is the desired order.</p>
</div>
</div>
<div id="S3.p10" class="ltx_para">
<p class="ltx_p">This won’t work all the time<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Not to mention the general issue of noise, but that’s for
engineers to worry about.
</span></span></span> (for example, we could get unlucky and
measure <math id="S3.p10.m1" class="ltx_Math" alttext="j=0" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow></math>, i.e. <math id="S3.p10.m2" class="ltx_Math" alttext="s=0" display="inline"><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow></math>, which would tell us no information at all).</p>
</div>
<div id="S3.p11" class="ltx_para">
<p class="ltx_p">But one can show that we succeed any time that</p>
<table id="Ex30" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex30.m1" class="ltx_Math" alttext="\gcd(s,r)=1." display="block"><mrow><mrow><mrow><mi>gcd</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p">This happens at least <math id="S3.p11.m1" class="ltx_Math" alttext="\frac{1}{\log r}" display="inline"><mfrac><mn>1</mn><mrow><mi>log</mi><mo lspace="0.167em">⁡</mo><mi>r</mi></mrow></mfrac></math> of the time,
and since <math id="S3.p11.m2" class="ltx_Math" alttext="r&lt;M" display="inline"><mrow><mi>r</mi><mo>&lt;</mo><mi>M</mi></mrow></math> this means that given sufficiently many trials,
we will eventually extract the correct order <math id="S3.p11.m3" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>.
This is Shor’s algorithm.</p>
</div>
</section>
</section>
</div>
<footer class="ltx_page_footer">
<div class="ltx_align_center">
<a href="ch_quantum_circuits.html" title="In Part VII Quantum Algorithms ‣ An Infinitely Large Napkin" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">24 </span>Quantum circuits</span></a><a href="../part_calc/" title="In An Infinitely Large Napkin" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VIII </span>Calculus 101</span></a>
</div>
<div class="ltx_page_logo">Generated  on Thu Feb 20 17:33:51 2025 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>
</body>
</html>
