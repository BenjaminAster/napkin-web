<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, interactive-widget=resizes-content, viewport-fit=cover" />
		<meta name="robots" content="all" />
		<meta name="referrer" content="no-referrer" />
		<meta name="author" content="Benjamin Aster" />
		<meta name="description" content="An infinitely large napkin" />
		<!-- <meta property="og:image" content="https://benjaminaster.com/NAME/assets/icon.png" /> -->
		<!-- <meta name="twitter:card" content="summary_large_image" /> -->
		<!-- <link rel="code-repository" href="https://github.com/BenjaminAster/NAME" /> -->
		<!-- <link rel="canonical" href="https://benjaminaster.com/NAME/" /> -->

		<title>Quantum circuits</title>
		<meta property="og:title" content="Quantum circuits" />

		<!-- <link rel="icon" href="https://venhance.github.io/napkin/cover-art.png" /> -->
		<link rel="icon" href="../assets/icon.png" />
		<!-- <link rel="aster:icon-dark" href="../assets/icon-dark.svg" /> -->
		<!-- <link rel="icon" href="../assets/icon.png" type="image/png" media="not (prefers-color-scheme: light)" sizes="512x512" /> -->
		<!-- <link rel="icon" href="../assets/icon-light.png" type="image/png" media="(prefers-color-scheme: light)" sizes="512x512" /> -->
		<meta name="color-scheme" content="dark light" />
		<!-- <meta name="theme-color" content="#111" /> -->
		<link rel="manifest" href="../_src/app.webmanifest" />

		<link rel="stylesheet" href="../_src/style.css" />
		<link rel="preload" as="style" href="../_src/latexml.css" />

		<script type="module" src="../_src/script.js"></script>

		<!-- <link rel="preload" as="font" crossorigin="anonymous" href="../assets/latinmodern-math/regular.otf" /> -->
		<link rel="preload" as="font" crossorigin="anonymous" href="../assets/newcomputermodern/regular.otf" />
		<link rel="preload" as="font" crossorigin="anonymous" href="../assets/newcomputermodern/bold.otf" />
		<link rel="preload" as="font" crossorigin="anonymous" href="../assets/newcomputermodern/italic.otf" />
		<link rel="preload" as="font" crossorigin="anonymous" href="../assets/newcomputermodern/bolditalic.otf" />
		<link rel="preload" as="font" crossorigin="anonymous" href="../assets/newcomputermodern/math.otf" />
	</head>
	<body>
		<main>
			
<nav>
<a href="../">Table of Contents</a><br />
<a href="../quantum/quantum-states-and-measurements.html">Previous chapter: Quantum states and measurements</a><br />
<a href="../quantum/shors-algorithm.html">Next chapter: Shor’s algorithm</a>
</nav>
<div class="ltx_page_content">
<section class="ltx_chapter">
<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter 24 </span>Quantum circuits</h1>

<div id="p1" class="ltx_para">
<p class="ltx_p">Now that we’ve discussed qubits, we can talk about how to use them in circuits.
The key change — and the reason that quantum circuits can do things that
classical circuits cannot — is the fact that we are allowing
linear combinations of <math id="p1.m1" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> and <math id="p1.m2" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">24.1 </span>Classical logic gates</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">In classical logic, we build circuits which take in some bits for input,
and output some more bits for input.
These circuits are built out of individual logic gates.
For example, the <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> AND gate</span> can be pictured as follows.</p>
<div class="table-container"><table id="Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<svg id="Ex1.m1.pic1" class="ltx_picture ltx_markedasmath" height="53.81" overflow="visible" version="1.1" width="69.34"><g transform="matrix(1 0 0 -1 0 14.49)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><g transform="translate(29.06,0) translate(0,-15.87) translate(0,-4.8)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="44.59"><span class="ltx_text ltx_markedasmath ltx_font_smallcaps">and</span></foreignObject></g><path class="droprule" d="M 22.14 10.75 L 58.27 11.31" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.86 -42.78 L 22.42 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -43.06 L 58.27 -42.5" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.99 -42.78 L 58.55 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(69.34,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 69.34 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 58.27 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-31.75) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 0 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(0,-31.75) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><path class="droprule" d="M 22.14 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">              </span><svg id="Ex1.m1.pic2" class="ltx_picture ltx_markedasmath" height="53.81" overflow="visible" version="1.1" width="69.34"><g transform="matrix(1 0 0 -1 0 14.49)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic2.m1" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><g transform="translate(29.06,0) translate(0,-15.87) translate(0,-4.8)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="44.59"><span class="ltx_text ltx_markedasmath ltx_font_smallcaps">and</span></foreignObject></g><path class="droprule" d="M 22.14 10.75 L 58.27 11.31" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.86 -42.78 L 22.42 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -43.06 L 58.27 -42.5" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.99 -42.78 L 58.55 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(69.34,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic2.m5" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 69.34 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 58.27 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-31.75) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic2.m6" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 0 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(0,-31.75) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><path class="droprule" d="M 22.14 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">              </span><svg id="Ex1.m1.pic3" class="ltx_picture ltx_markedasmath" height="53.81" overflow="visible" version="1.1" width="69.34"><g transform="matrix(1 0 0 -1 0 14.49)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic3.m1" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><g transform="translate(29.06,0) translate(0,-15.87) translate(0,-4.8)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="44.59"><span class="ltx_text ltx_markedasmath ltx_font_smallcaps">and</span></foreignObject></g><path class="droprule" d="M 22.14 10.75 L 58.27 11.31" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.86 -42.78 L 22.42 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -43.06 L 58.27 -42.5" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.99 -42.78 L 58.55 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(69.34,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic3.m5" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 69.34 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 58.27 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-31.75) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic3.m6" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 0 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(0,-31.75) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><path class="droprule" d="M 22.14 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">              </span><svg id="Ex1.m1.pic4" class="ltx_picture ltx_markedasmath" height="53.81" overflow="visible" version="1.1" width="69.34"><g transform="matrix(1 0 0 -1 0 14.49)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic4.m1" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><g transform="translate(29.06,0) translate(0,-15.87) translate(0,-4.8)"><foreignObject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="44.59"><span class="ltx_text ltx_markedasmath ltx_font_smallcaps">and</span></foreignObject></g><path class="droprule" d="M 22.14 10.75 L 58.27 11.31" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.86 -42.78 L 22.42 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -43.06 L 58.27 -42.5" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.99 -42.78 L 58.55 11.03" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(69.34,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic4.m5" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 69.34 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 69.34 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 58.27 -0.28 L 58.27 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-31.75) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex1.m1.pic4.m6" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -32.02 L 0 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(0,-31.75) translate(6.92,0) translate(0,-4.8)"><text transform="matrix(1 0 0 -1 0 0)">     </text></g><path class="droprule" d="M 22.14 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 22.14 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -32.02 L 11.07 -31.47" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">One can also represent the AND gate using the “truth table”:</p>
<div class="table-container"><table id="Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex2.m1" class="ltx_Math" alttext="\begin{array}[]{|cc|c|}\hline\cr A&amp;B&amp;A\text{ and }B\\
\hline\cr 0&amp;0&amp;0\\
0&amp;1&amp;0\\
1&amp;0&amp;0\\
1&amp;1&amp;1\\
\hline\cr\end{array}" display="block"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l"><mi>A</mi></mtd><mtd class="ltx_border_r"><mi>B</mi></mtd><mtd class="ltx_border_r"><mrow><mi>A</mi><mo>⁢</mo><mtext> and </mtext><mo>⁢</mo><mi>B</mi></mrow></mtd></mtr><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>1</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l"><mn>1</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_b ltx_border_l"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r"><mn>1</mn></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Similarly, we have the <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> OR gate</span> and the <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> NOT gate</span>:</p>
<div class="table-container"><table id="Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex3.m1" class="ltx_Math" alttext="\begin{array}[]{|cc|c|}\hline\cr A&amp;B&amp;A\text{ or }B\\
\hline\cr 0&amp;0&amp;0\\
0&amp;1&amp;1\\
1&amp;0&amp;1\\
1&amp;1&amp;1\\
\hline\cr\end{array}\qquad\begin{array}[]{|c|c|}\hline\cr A&amp;\text{not }A\\
\hline\cr 0&amp;1\\
1&amp;0\\
\hline\cr\end{array}" display="block"><mrow><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l"><mi>A</mi></mtd><mtd class="ltx_border_r"><mi>B</mi></mtd><mtd class="ltx_border_r"><mrow><mi>A</mi><mo>⁢</mo><mtext> or </mtext><mo>⁢</mo><mi>B</mi></mrow></mtd></mtr><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>1</mn></mtd><mtd class="ltx_border_r"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_l"><mn>1</mn></mtd><mtd class="ltx_border_r"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_b ltx_border_l"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r"><mn>1</mn></mtd></mtr></mtable><mspace width="2.334em"></mspace><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l ltx_border_r"><mi>A</mi></mtd><mtd class="ltx_border_r"><mrow><mtext>not </mtext><mo>⁢</mo><mi>A</mi></mrow></mtd></mtr><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l ltx_border_r"><mn>0</mn></mtd><mtd class="ltx_border_r"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_b ltx_border_l ltx_border_r"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r"><mn>0</mn></mtd></mtr></mtable></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">We also have a so-called <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> COPY gate</span>, which duplicates a bit.</p>
<div class="table-container"><table id="Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<svg id="Ex4.m1.pic1" class="ltx_picture ltx_markedasmath" height="30.79" overflow="visible" version="1.1" width="85.79"><g transform="matrix(1 0 0 -1 0 14.01)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex4.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(6.92,0) translate(0,-1.63)"><text transform="matrix(1 0 0 -1 0 0)">      </text></g><g transform="translate(29.06,0) translate(0,-4.84) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="55.35"><span class="ltx_text ltx_markedasmath ltx_font_smallcaps">copy</span></foreignObject></g><path class="droprule" d="M 22.14 10.27 L 63.65 10.83" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.86 -20.24 L 22.42 10.55" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -20.51 L 63.65 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 63.37 -20.24 L 63.93 10.55" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(74.72,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex4.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 74.72 -0.28 L 74.72 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 63.65 -0.28 L 74.72 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 63.65 -0.28 L 63.65 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(74.72,0) translate(0,-20.24) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex4.m1.pic1.m10" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><path class="droprule" d="M 74.72 -20.51 L 74.72 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 42.89 -20.51 L 74.72 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">            </span><svg id="Ex4.m1.pic2" class="ltx_picture ltx_markedasmath" height="30.79" overflow="visible" version="1.1" width="85.79"><g transform="matrix(1 0 0 -1 0 14.01)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex4.m1.pic2.m1" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(22.14,0) translate(6.92,0) translate(0,-1.63)"><text transform="matrix(1 0 0 -1 0 0)">      </text></g><g transform="translate(29.06,0) translate(0,-4.84) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="55.35"><span class="ltx_text ltx_markedasmath ltx_font_smallcaps">copy</span></foreignObject></g><path class="droprule" d="M 22.14 10.27 L 63.65 10.83" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.86 -20.24 L 22.42 10.55" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -20.51 L 63.65 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 63.37 -20.24 L 63.93 10.55" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 22.14 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 22.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -0.28 L 11.07 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(74.72,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex4.m1.pic2.m5" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 74.72 -0.28 L 74.72 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 63.65 -0.28 L 74.72 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 63.65 -0.28 L 63.65 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(74.72,0) translate(0,-20.24) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex4.m1.pic2.m10" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 74.72 -20.51 L 74.72 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 42.89 -20.51 L 74.72 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Of course, the first theorem you learn about these gates is that:</p>
</div>
<div id="S1.Thmtheorem1" class="ltx_theorem ltx_theorem_theorem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);">Theorem 24.1.1</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);"> <span class="ltx_text ltx_font_medium">(AND, OR, NOT, COPY are universal)
<br class="ltx_break"></span></span>
</h5>
<div id="S1.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p">The set of four gates AND, OR, NOT, COPY is universal in the sense that
any boolean function <math id="S1.Thmtheorem1.p1.m1" class="ltx_Math" alttext="f\colon\{0,1\}^{n}\to\{0,1\}" display="inline"><mrow><mi>f</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><mi>n</mi></msup><mo stretchy="false">→</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></mrow></math>
can be implemented as a circuit using only these gates.</p>
</div>
</div>
<div class="ltx_proof">
<h5 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h5>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">Somewhat silly: we essentially write down a circuit that OR’s across
all input strings in <math id="S1.p2.m1" class="ltx_Math" alttext="f^{\text{pre}}(1)" display="inline"><mrow><msup><mi>f</mi><mtext>pre</mtext></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math>.
For example, suppose we have <math id="S1.p2.m2" class="ltx_Math" alttext="n=3" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>3</mn></mrow></math> and want to simulate the function
<math id="S1.p2.m3" class="ltx_Math" alttext="f(abc)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mo>⁢</mo><mi>b</mi><mo>⁢</mo><mi>c</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math> with <math id="S1.p2.m4" class="ltx_Math" alttext="f(011)=f(110)=1" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>011</mn><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>110</mn><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math> and <math id="S1.p2.m5" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> otherwise.
Then the corresponding Boolean expression for <math id="S1.p2.m6" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is simply</p>
<div class="table-container"><table id="Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex5.m1" class="ltx_Math" alttext="f(abc)=\left[\text{(not $a$) and $b$ and $c$}\right]\text{ or }\left[\text{$a$%
 and $b$ and (not $c$)}\right]." display="block"><mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mo>⁢</mo><mi>b</mi><mo>⁢</mo><mi>c</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>[</mo><mrow><mtext>(not </mtext><mi>a</mi><mtext>) and </mtext><mi>b</mi><mtext> and </mtext><mi>c</mi></mrow><mo>]</mo></mrow><mo>⁢</mo><mtext> or </mtext><mo>⁢</mo><mrow><mo>[</mo><mrow><mi>a</mi><mtext> and </mtext><mi>b</mi><mtext> and (not </mtext><mi>c</mi><mtext>)</mtext></mrow><mo>]</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Clearly, one can do the same for any other <math id="S1.p2.m7" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math>,
and implement this logic into a circuit.
<sub title="End of proof">◻︎</sub></p>
</div>
</div>
<div id="S1.Thmtheorem2" class="ltx_theorem ltx_theorem_remark">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-186118);">Remark 24.1.2</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-186118);"> — </span>
</h5>
<div id="S1.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">Since
<math id="S1.Thmtheorem2.p1.m1" class="ltx_Math" alttext="x\text{ and }y=\text{not }((\text{not $x$})\text{ or }(\text{not $y$}))" display="inline"><mrow><mrow><mi>x</mi><mo>⁢</mo><mtext> and </mtext><mo>⁢</mo><mi>y</mi></mrow><mo>=</mo><mrow><mtext>not </mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mtext>not </mtext><mi>x</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mtext> or </mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mtext>not </mtext><mi>y</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>,
it follows that in fact, we can dispense with the AND gate.</p>
</div>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">24.2 </span>Reversible classical logic</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p"><em class="ltx_emph ltx_font_italic"><span class="ltx_text" style="color:var(--latex-color-FF0000);">Prototypical example for this section:</span> CNOT gate, Toffoli gate.</em></p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p">For the purposes of quantum mechanics, this is not enough.
To carry through the analogy we in fact need gates that are <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> reversible</span>,
meaning the gates are bijections from the input space to the output space.
In particular, such gates must take the same number of input and output gates.</p>
</div>
<div id="S2.Thmtheorem1" class="ltx_theorem ltx_theorem_example">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" style="color:var(--latex-color-8C0000);">Example 24.2.1</span></span><span class="ltx_text ltx_font_bold" style="color:var(--latex-color-8C0000);"> <span class="ltx_text ltx_font_medium">(Reversible gates)
<br class="ltx_break"></span></span>
</h5>
<div id="S2.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p"></p>
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p class="ltx_p">None of the gates AND, OR, COPY are reversible for dimension reasons.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p class="ltx_p">The NOT gate, however, is reversible:
it is a bijection <math id="S2.I1.i2.p1.m1" class="ltx_Math" alttext="\{0,1\}\to\{0,1\}" display="inline"><mrow><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><mo stretchy="false">→</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></math>.</p>
</div>
</li>
</ol>
</div>
</div>
<div id="S2.Thmtheorem2" class="ltx_theorem ltx_theorem_example">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" style="color:var(--latex-color-8C0000);">Example 24.2.2</span></span><span class="ltx_text ltx_font_bold" style="color:var(--latex-color-8C0000);"> <span class="ltx_text ltx_font_medium">(The CNOT gate)
<br class="ltx_break"></span></span>
</h5>
<div id="S2.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">The controlled-NOT gate, or the <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> CNOT</span> gate,
is a reversible <math id="S2.Thmtheorem2.p1.m1" class="ltx_Math" alttext="2" display="inline"><mn>2</mn></math>-bit gate with the following truth table.</p>
<div class="table-container"><table id="Ex6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex6.m1" class="ltx_Math" alttext="\begin{array}[]{|rr|rr|}\hline\cr\vrule\lx@intercol\hfil\text{In}\hfil%
\lx@intercol\vrule\lx@intercol&amp;\vrule\lx@intercol\hfil\text{Out}\hfil%
\lx@intercol\vrule\lx@intercol\\
\hline\cr 0&amp;0&amp;0&amp;0\\
1&amp;0&amp;1&amp;1\\
0&amp;1&amp;0&amp;1\\
1&amp;1&amp;1&amp;0\\
\hline\cr\end{array}" display="block"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l ltx_border_r" columnspan="2"><mtext>In</mtext></mtd><mtd class="ltx_border_l ltx_border_r" columnspan="2"><mtext>Out</mtext></mtd></mtr><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_b ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">In other words, this gate XOR’s the first bit to the second bit,
while leaving the first bit unchanged.
It is depicted as follows.</p>
<div class="table-container"><table id="Ex7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex7.m1.pic1" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="48.43"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-14.83,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex7.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex7.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -1.88 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(6.92,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex7.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 15.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-14.2,0) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.28"><math id="Ex7.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{y}" display="inline"><mi>y</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex7.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 15.53 -20.51 L 13.84 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -20.51 L 13.84 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="65.54"><math id="Ex7.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{x+y\mod 2}" display="inline"><mrow><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow><mo>mod</mo><mn>2</mn></mrow></math></foreignObject></g><path class="droprule" d="M 48.43 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 15.53 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">The first dot is called the “control”,
while the <math id="S2.Thmtheorem2.p1.m2" class="ltx_Math" alttext="\oplus" display="inline"><mo>⊕</mo></math> is the “negation” operation:
the first bit controls whether the second bit gets flipped or not.
Thus, a typical application might be as follows.</p>
<div class="table-container"><table id="Ex8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex8.m1.pic1" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="48.43"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex8.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><g transform="translate(12.15,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex8.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -1.88 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex8.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 48.43 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 15.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex8.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex8.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 15.53 -20.51 L 13.84 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -20.51 L 13.84 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-20.24) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex8.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 48.43 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 15.53 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
</div>
</div>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">So, NOT and CNOT are the only nontrivial reversible gates on two bits.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p class="ltx_p">We now need a different definition of universal for our reversible gates.</p>
</div>
<div id="S2.Thmtheorem3" class="ltx_theorem ltx_theorem_definition">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 24.2.3</span></span><span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="S2.Thmtheorem3.p1" class="ltx_para">
<p class="ltx_p">A set of reversible gates can <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> simulate</span> a Boolean function <math id="S2.Thmtheorem3.p1.m1" class="ltx_Math" alttext="f(x_{1}\dots x_{n})" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></math>,
if one can implement a circuit which takes</p>
<ul id="S2.I2" class="ltx_itemize">
<li id="S2.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I2.i1.p1" class="ltx_para">
<p class="ltx_p">As input, <math id="S2.I2.i1.p1.m1" class="ltx_Math" alttext="x_{1}\dots x_{n}" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></math> plus some fixed bits set to <math id="S2.I2.i1.p1.m2" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> or <math id="S2.I2.i1.p1.m3" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>,
called <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> ancilla bits<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" style="color:var(--latex-color-000000);">1</span></span><span class="ltx_text ltx_font_medium" style="color:var(--latex-color-000000);">The English word “ancilla” means “maid”.</span></span></span></span></span>.</p>
</div>
</li>
<li id="S2.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I2.i2.p1" class="ltx_para">
<p class="ltx_p">As output, the input bits <math id="S2.I2.i2.p1.m1" class="ltx_Math" alttext="x_{1},\dots,x_{n}" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></math>,
the output bit <math id="S2.I2.i2.p1.m2" class="ltx_Math" alttext="f(x_{1},\dots,x_{n})" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math>,
and possibly some extra bits (called <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> garbage bits</span>).</p>
</div>
</li>
</ul>
<p class="ltx_p">The gate(s) are <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> universal</span> if they can simulate any Boolean function.</p>
</div>
</div>
<div id="S2.p5" class="ltx_para">
<p class="ltx_p">For example, the CNOT gate can simulate the NOT gate,
using a single ancilla bit <math id="S2.p5.m1" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>,
according to the following circuit.</p>
<div class="table-container"><table id="Ex9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex9.m1.pic1" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="48.43"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-14.83,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex9.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex9.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -1.88 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(6.92,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex9.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 15.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex9.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex9.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 15.53 -20.51 L 13.84 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -20.51 L 13.84 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-20.24) translate(6.92,0) translate(0,-4.26)"><foreignObject height="8.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="32.51"><math id="Ex9.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\text{not }x}" display="inline"><mrow><mtext>not </mtext><mo>⁢</mo><mi>x</mi></mrow></math></foreignObject></g><path class="droprule" d="M 48.43 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 15.53 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Unfortunately, it is not universal.</p>
</div>
<div id="S2.Thmtheorem4" class="ltx_theorem ltx_theorem_proposition">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);">Proposition 24.2.4</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);"> <span class="ltx_text ltx_font_medium">(CNOT <math id="S2.Thmtheorem4.m1" class="ltx_Math" alttext="\not\Rightarrow" display="inline"><mo stretchy="false">⇏</mo></math> AND)
<br class="ltx_break"></span></span>
</h5>
<div id="S2.Thmtheorem4.p1" class="ltx_para">
<p class="ltx_p">The CNOT gate cannot simulate the boolean function “<math id="S2.Thmtheorem4.p1.m1" class="ltx_Math" alttext="x\text{ and }y" display="inline"><mrow><mi>x</mi><mo>⁢</mo><mtext> and </mtext><mo>⁢</mo><mi>y</mi></mrow></math>”.</p>
</div>
</div>
<div class="ltx_proof">
<h5 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Sketch of Proof.</h5>
<div id="S2.p6" class="ltx_para">
<p class="ltx_p">One can see that any function simulated using only CNOT gates
must be of the form</p>
<div class="table-container"><table id="Ex10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex10.m1" class="ltx_Math" alttext="a_{1}x_{1}+a_{2}x_{2}+\dots+a_{n}x_{n}\pmod{2}" display="block"><mrow><mrow><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><mo>+</mo><mi mathvariant="normal">⋯</mi><mo>+</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></mrow><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" movablelimits="false" rspace="0.167em">mod</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">because CNOT is the map <math id="S2.p6.m1" class="ltx_Math" alttext="(x,y)\mapsto(x,x+y)" display="inline"><mrow><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo stretchy="false">↦</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.
Thus, even with ancilla bits, we can only create functions
of the form <math id="S2.p6.m2" class="ltx_Math" alttext="ax+by+c\pmod{2}" display="inline"><mrow><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mrow><mi>b</mi><mo>⁢</mo><mi>y</mi></mrow><mo>+</mo><mi>c</mi></mrow><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></math> for fixed <math id="S2.p6.m3" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math>, <math id="S2.p6.m4" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math>, <math id="S2.p6.m5" class="ltx_Math" alttext="c" display="inline"><mi>c</mi></math>.
The AND gate is not of this form.
<sub title="End of proof">◻︎</sub></p>
</div>
</div>
<div id="S2.p7" class="ltx_para">
<p class="ltx_p">So, we need at least a three-qubit gate.
The most commonly used one is:</p>
</div>
<div id="S2.Thmtheorem5" class="ltx_theorem ltx_theorem_definition">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 24.2.5</span></span><span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="S2.Thmtheorem5.p1" class="ltx_para">
<p class="ltx_p">The three-bit <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> Toffoli gate</span>, also called the CCNOT gate, is given by</p>
<div class="table-container"><table id="Ex11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex11.m1.pic1" class="ltx_picture ltx_markedasmath" height="33.3" overflow="visible" version="1.1" width="48.43"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-14.83,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex11.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex11.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -1.88 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(6.92,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex11.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 15.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-14.2,0) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.28"><math id="Ex11.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{y}" display="inline"><mi>y</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex11.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -22.12 L 14.11 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -28.42 L 14.11 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -28.42 L 14.11 -28.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-20.24) translate(6.92,0) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.28"><math id="Ex11.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{y}" display="inline"><mi>y</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 15.53 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-29.92) translate(-13.96,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.04"><math id="Ex11.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{z}" display="inline"><mi>z</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-29.92) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex11.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 15.53 -30.2 L 13.84 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -30.2 L 13.84 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 0 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-29.92) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="90.65"><math id="Ex11.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{z+xy\pmod{2}}" display="inline"><mrow><mrow><mi>z</mi><mo>+</mo><mrow><mi>x</mi><mo>⁢</mo><mi>y</mi></mrow></mrow><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></math></foreignObject></g><path class="droprule" d="M 48.43 -30.2 L 48.43 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -30.2 L 48.43 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -30.2 L 15.53 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">So the Toffoli has two controls, and toggles the last bit if and only if
both of the control bits are <math id="S2.Thmtheorem5.p1.m1" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>.</p>
</div>
</div>
<div id="S2.p8" class="ltx_para">
<p class="ltx_p">This replacement is sufficient.</p>
</div>
<div id="S2.Thmtheorem6" class="ltx_theorem ltx_theorem_theorem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);">Theorem 24.2.6</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);"> <span class="ltx_text ltx_font_medium">(Toffoli gate is universal)
<br class="ltx_break"></span></span>
</h5>
<div id="S2.Thmtheorem6.p1" class="ltx_para">
<p class="ltx_p">The Toffoli gate is universal.</p>
</div>
</div>
<div class="ltx_proof">
<h5 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h5>
<div id="S2.p9" class="ltx_para">
<p class="ltx_p">We will show it can <em class="ltx_emph ltx_font_italic">reversibly</em> simulate
AND, NOT, hence OR,
which we know is enough to show universality.
(We don’t need COPY because of reversibility.)</p>
</div>
<div id="S2.p10" class="ltx_para">
<p class="ltx_p">For the AND gate, we draw the circuit</p>
<div class="table-container"><table id="Ex12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex12.m1.pic1" class="ltx_picture ltx_markedasmath" height="33.3" overflow="visible" version="1.1" width="48.43"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-14.83,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex12.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex12.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -1.88 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(6.92,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math id="Ex12.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{x}" display="inline"><mi>x</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 15.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-14.2,0) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.28"><math id="Ex12.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{y}" display="inline"><mi>y</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex12.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -22.12 L 14.11 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -28.42 L 14.11 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -28.42 L 14.11 -28.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-20.24) translate(6.92,0) translate(0,-1.63)"><foreignObject height="8.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.28"><math id="Ex12.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{y}" display="inline"><mi>y</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 15.53 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-29.92) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex12.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{0}" display="inline"><mn>0</mn></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-29.92) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex12.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 15.53 -30.2 L 13.84 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -30.2 L 13.84 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 0 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-29.92) translate(6.92,0) translate(0,-3.46)"><foreignObject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="46.71"><math id="Ex12.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{x\text{ and }y}" display="inline"><mrow><mi>x</mi><mo>⁢</mo><mtext> and </mtext><mo>⁢</mo><mi>y</mi></mrow></math></foreignObject></g><path class="droprule" d="M 48.43 -30.2 L 48.43 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -30.2 L 48.43 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -30.2 L 15.53 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">with one ancilla bit, and no garbage bits.</p>
</div>
<div id="S2.p11" class="ltx_para">
<p class="ltx_p">For the NOT gate, we use two ancilla <math id="S2.p11.m1" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math> bits and one garbage bit:</p>
<div class="table-container"><table id="Ex13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex13.m1.pic1" class="ltx_picture ltx_markedasmath" height="33.3" overflow="visible" version="1.1" width="48.43"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex13.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><g transform="translate(12.15,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex13.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -1.88 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -18.74 L 14.11 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 12.15 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(6.92,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex13.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><path class="droprule" d="M 48.43 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 48.43 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -0.28 L 15.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-13.96,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.04"><math id="Ex13.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{z}" display="inline"><mi>z</mi></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex13.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 13.56 -22.12 L 14.11 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -28.42 L 14.11 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -28.42 L 14.11 -28.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 12.15 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-20.24) translate(6.92,0) translate(0,-2.98)"><foreignObject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.04"><math id="Ex13.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{z}" display="inline"><mi>z</mi></math></foreignObject></g><path class="droprule" d="M 48.43 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 48.43 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -20.51 L 15.53 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-29.92) translate(-13.84,0) translate(0,-4.46)"><foreignObject height="8.92" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex13.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{1}" display="inline"><mn>1</mn></math></foreignObject></g><g transform="translate(12.15,0) translate(0,-29.92) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex13.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 15.53 -30.2 L 13.84 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -30.2 L 13.84 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.15 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 12.15 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 0 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.43,0) translate(0,-29.92) translate(6.92,0) translate(0,-4.26)"><foreignObject height="8.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="31.64"><math id="Ex13.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{\text{not }z}" display="inline"><mrow><mtext>not </mtext><mo>⁢</mo><mi>z</mi></mrow></math></foreignObject></g><path class="droprule" d="M 48.43 -30.2 L 48.43 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -30.2 L 48.43 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 15.53 -30.2 L 15.53 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">This completes the proof.
<sub title="End of proof">◻︎</sub></p>
</div>
</div>
<div id="S2.p12" class="ltx_para">
<p class="ltx_p">Hence, in theory we can create any classical circuit we desire
using the Toffoli gate alone.
Of course, this could require exponentially many gates for even the
simplest of functions.
Fortunately, this is NO BIG DEAL because I’m a math major,
and having <math id="S2.p12.m1" class="ltx_Math" alttext="2^{n}" display="inline"><msup><mn>2</mn><mi>n</mi></msup></math> gates is a problem best left for the CS majors.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">24.3 </span>Quantum logic gates</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">In quantum mechanics, since we can have <em class="ltx_emph ltx_font_italic">linear combinations</em> of basis
elements, our logic gates will instead consist of <em class="ltx_emph ltx_font_italic">linear maps</em>.
Moreover, in quantum computation, gates are always reversible,
which was why we took the time in the previous section to show
that we can still simulate any function when restricted to reversible gates
(e.g. using the Toffoli gate).</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">First, some linear algebra:</p>
</div>
<div id="S3.Thmtheorem1" class="ltx_theorem ltx_theorem_definition">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition 24.3.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="S3.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p">Let <math id="S3.Thmtheorem1.p1.m1" class="ltx_Math" alttext="V" display="inline"><mi>V</mi></math> be a finite dimensional inner product space.
Then for a map <math id="S3.Thmtheorem1.p1.m2" class="ltx_Math" alttext="U\colon V\to V" display="inline"><mrow><mi>U</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mi>V</mi><mo stretchy="false">→</mo><mi>V</mi></mrow></mrow></math>, the following are equivalent:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p class="ltx_p"><math id="S3.I1.i1.p1.m1" class="ltx_Math" alttext="\left&lt;U(x),U(y)\right&gt;=\left&lt;x,y\right&gt;" display="inline"><mrow><mrow><mo>⟨</mo><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>⟩</mo></mrow><mo>=</mo><mrow><mo>⟨</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>⟩</mo></mrow></mrow></math> for <math id="S3.I1.i1.p1.m2" class="ltx_Math" alttext="x,y\in V" display="inline"><mrow><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>∈</mo><mi>V</mi></mrow></math>.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p class="ltx_p"><math id="S3.I1.i2.p1.m1" class="ltx_Math" alttext="U^{\dagger}" display="inline"><msup><mi>U</mi><mo>†</mo></msup></math> is the inverse of <math id="S3.I1.i2.p1.m2" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math>.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p class="ltx_p"><math id="S3.I1.i3.p1.m1" class="ltx_Math" alttext="\left\lVert x\right\rVert=\left\lVert U(x)\right\rVert" display="inline"><mrow><mrow><mo fence="true" rspace="0em" stretchy="true">‖</mo><mi>x</mi><mo fence="true" lspace="0em" rspace="0.1389em" stretchy="true">∥</mo></mrow><mo lspace="0.1389em" rspace="0.1389em">=</mo><mrow><mo fence="true" lspace="0.1389em" rspace="0em" stretchy="true">∥</mo><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo fence="true" lspace="0em" stretchy="true">‖</mo></mrow></mrow></math> for <math id="S3.I1.i3.p1.m2" class="ltx_Math" alttext="x\in V" display="inline"><mrow><mi>x</mi><mo>∈</mo><mi>V</mi></mrow></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p">The map <math id="S3.Thmtheorem1.p1.m3" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math> is called <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> unitary</span>
if it satisfies these equivalent conditions.</p>
</div>
</div>
<div id="S3.p3" class="ltx_para">
<p class="ltx_p">Then</p>
</div>
<div id="S3.Thmtheorem2" class="ltx_theorem ltx_theorem_moral">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-186118);">Moral 24.3.2</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-186118);"> — </span>
</h5>
<div id="S3.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">Quantum logic gates are unitary matrices.</p>
</div>
</div>
<div id="S3.p4" class="ltx_para">
<p class="ltx_p">In particular, unlike the classical situation,
quantum gates are always reversible
(and hence they always take the same number of input and output bits).</p>
</div>
<div id="S3.p5" class="ltx_para">
<p class="ltx_p">For example, consider the CNOT gate.
Its quantum analog should be a unitary map <math id="S3.p5.m1" class="ltx_Math" alttext="U_{\mathrm{CNOT}}\colon H\to H" display="inline"><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mi>H</mi><mo stretchy="false">→</mo><mi>H</mi></mrow></mrow></math>,
where <math id="S3.p5.m2" class="ltx_Math" alttext="H=\mathbb{C}^{\oplus 2}\otimes\mathbb{C}^{\oplus 2}" display="inline"><mrow><mi>H</mi><mo>=</mo><mrow><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">⊗</mo><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup></mrow></mrow></math>,
given on basis elements by</p>
<div class="table-container"><table id="Ex14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex14.m1" class="ltx_Math" alttext="U_{\mathrm{CNOT}}(\ket{00})=\ket{00},\quad U_{\mathrm{CNOT}}(\ket{01})=\ket{01}" display="block"><mrow><mrow><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mn>00</mn><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>00</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mn>01</mn><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>01</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<div class="table-container"><table id="Ex15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex15.m1" class="ltx_Math" alttext="U_{\mathrm{CNOT}}(\ket{10})=\ket{11},\quad U_{\mathrm{CNOT}}(\ket{11})=\ket{10}." display="block"><mrow><mrow><mrow><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mn>10</mn><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>11</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mn>11</mn><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>10</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">So pictorially, the quantum CNOT gate is given by</p>
<div class="table-container"><table id="Ex16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<svg id="Ex16.m1.pic1" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 12.76 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 12.76 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">                  </span><svg id="Ex16.m1.pic2" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic2.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic2.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic2.m3" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic2.m4" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic2.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 12.76 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic2.m6" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 12.76 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">                  </span><svg id="Ex16.m1.pic3" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic3.m1" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic3.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic3.m3" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic3.m4" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic3.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 12.76 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic3.m6" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 12.76 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">                  </span><svg id="Ex16.m1.pic4" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic4.m1" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic4.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic4.m3" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic4.m4" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex16.m1.pic4.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 12.76 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex16.m1.pic4.m6" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 12.76 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">OK, so what?
The whole point of quantum mechanics is that we allow linear
qubits to be in linear combinations of <math id="S3.p5.m3" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math> and <math id="S3.p5.m4" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math>,
too, and this will produce interesting results.
For example, let’s take <math id="S3.p5.m5" class="ltx_Math" alttext="\ket{\leftarrow}=\frac{1}{\sqrt{2}}(\ket{0}-\ket{1})" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
and plug it into the top, with <math id="S3.p5.m6" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math> on the bottom, and see what happens:</p>
<div class="table-container"><table id="Ex17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex17.m1" class="ltx_Math" alttext="U_{\mathrm{CNOT}}\left(\ket{\leftarrow}\otimes\ket{1}\right)=U_{\mathrm{CNOT}}%
\left(\frac{1}{\sqrt{2}}(\ket{01}-\ket{11})\right)=\frac{1}{\sqrt{2}}\left(%
\ket{01}-\ket{10}\right)=\ket{\Psi_{-}}" display="block"><mrow><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>U</mi><mi>CNOT</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>01</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>11</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>01</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>10</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><msub><mi mathvariant="normal">Ψ</mi><mo>−</mo></msub><mo stretchy="false">⟩</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">which is the fully entangled <em class="ltx_emph ltx_font_italic">singlet state</em>! Picture:</p>
<div class="table-container"><table id="Ex18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex18.m1.pic1" class="ltx_picture ltx_markedasmath" height="23.62" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-29.98,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="23.06"><math id="Ex18.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{\leftarrow}}" display="inline"><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex18.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="22.57"><math id="Ex18.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\ket{\Psi_{-}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi mathvariant="normal">Ψ</mi><mo>−</mo></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex18.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex18.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 12.76 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 11.07 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 12.76 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
</div>
<div id="S3.p6" class="ltx_para">
<p class="ltx_p">Thus, when we input mixed states into our quantum gates,
the outputs are often entangled states,
even when the original inputs are not entangled.</p>
</div>
<div id="S3.Thmtheorem3" class="ltx_theorem ltx_theorem_example">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" style="color:var(--latex-color-8C0000);">Example 24.3.3</span></span><span class="ltx_text ltx_font_bold" style="color:var(--latex-color-8C0000);"> <span class="ltx_text ltx_font_medium">(More examples of quantum gates)
<br class="ltx_break"></span></span>
</h5>
<div id="S3.Thmtheorem3.p1" class="ltx_para">
<p class="ltx_p"></p>
<ol id="S3.I2" class="ltx_enumerate">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p class="ltx_p">Every reversible classical gate that we encountered before
has a quantum analog obtained in the same way as CNOT:
by specifying the values on basis elements.
For example, there is a quantum Tofolli gate which
for example sends</p>
<div class="table-container"><table id="Ex19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex19.m1.pic1" class="ltx_picture ltx_markedasmath" height="33.3" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex19.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex19.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -18.74 L 11.35 -18.74" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex19.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex19.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-20.24) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex19.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -22.12 L 11.35 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -28.42 L 11.35 -22.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -28.42 L 11.35 -28.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 9.38 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex19.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -20.51 L 12.76 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-29.92) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex19.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(0,-29.92) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex19.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 12.76 -30.2 L 11.07 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -30.2 L 11.07 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 11.07 -30.2 L 9.38 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -30.2 L 9.38 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 9.38 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -30.2 L 0 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-29.92) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex19.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -30.2 L 42.89 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -30.2 L 42.89 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -30.2 L 12.76 -29.65" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p class="ltx_p">The <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> Hadamard gate</span> on one qubit is a rotation given by</p>
<div class="table-container"><table id="Ex20" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex20.m1" class="ltx_Math" alttext="\begin{bmatrix}\frac{1}{\sqrt{2}}&amp;\frac{1}{\sqrt{2}}\\
\frac{1}{\sqrt{2}}&amp;-\frac{1}{\sqrt{2}}\end{bmatrix}." display="block"><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><mstyle displaystyle="false"><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle></mtd><mtd><mstyle displaystyle="false"><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false"><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle></mtd><mtd><mrow><mo>−</mo><mstyle displaystyle="false"><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Thus, it sends <math id="S3.I2.i2.p1.m1" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math> to <math id="S3.I2.i2.p1.m2" class="ltx_Math" alttext="\ket{\rightarrow}" display="inline"><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">→</mo><mo stretchy="false">⟩</mo></mrow></math> and <math id="S3.I2.i2.p1.m3" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math> to <math id="S3.I2.i2.p1.m4" class="ltx_Math" alttext="\ket{\leftarrow}" display="inline"><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></math>.
Note that the Hadamard gate is its own inverse.
It is depicted by an “<math id="S3.I2.i2.p1.m5" class="ltx_Math" alttext="H" display="inline"><mi>H</mi></math>” box.</p>
<div class="table-container"><table id="Ex21" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex21.m1.pic1" class="ltx_picture ltx_markedasmath" height="17.76" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 12.34)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex21.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(0.61,0) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex21.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 0.61 8.6 L 21.53 9.16" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0.33 -8.88 L 0.88 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0.61 -9.16 L 21.53 -8.6" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.26 -8.88 L 21.81 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0.61 -0.28 L 0.61 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0.61 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex21.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\ket{\rightarrow}}" display="inline"><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">→</mo><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.53 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21.53 -0.28 L 21.53 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
</div>
</li>
<li id="S3.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span> 
<div id="S3.I2.i3.p1" class="ltx_para">
<p class="ltx_p">More generally, if <math id="S3.I2.i3.p1.m1" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math> is a <math id="S3.I2.i3.p1.m2" class="ltx_Math" alttext="2\times 2" display="inline"><mrow><mn>2</mn><mo lspace="0.222em" rspace="0.222em">×</mo><mn>2</mn></mrow></math> unitary matrix
(i.e. a map <math id="S3.I2.i3.p1.m3" class="ltx_Math" alttext="\mathbb{C}^{\oplus 2}\to\mathbb{C}^{\oplus 2}" display="inline"><mrow><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup><mo stretchy="false">→</mo><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup></mrow></math>) then
there is <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> <math id="S3.I2.i3.p1.m4" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math>-rotation gate</span> similar to the previous one,
which applies <math id="S3.I2.i3.p1.m5" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math> to the input.</p>
<div class="table-container"><table id="Ex22" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex22.m1.pic1" class="ltx_picture ltx_markedasmath" height="17.76" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 12.34)"><g transform="translate(-25.16,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex22.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(1.44,0) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.96"><math id="Ex22.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{U}" display="inline"><mi>U</mi></math></foreignObject></g><path class="droprule" d="M 1.44 8.6 L 20.7 9.16" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.16 -8.88 L 1.72 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.44 -9.16 L 20.7 -8.6" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.42 -8.88 L 20.98 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.44 -0.28 L 1.44 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 1.44 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.19"><math id="Ex22.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{U\ket{\psi}}" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.7 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.7 -0.28 L 20.7 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">For example, the classical NOT gate is represented by <math id="S3.I2.i3.p1.m6" class="ltx_Math" alttext="U=\sigma_{x}" display="inline"><mrow><mi>U</mi><mo>=</mo><msub><mi>σ</mi><mi>x</mi></msub></mrow></math>.</p>
</div>
</li>
<li id="S3.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(d)</span> 
<div id="S3.I2.i4.p1" class="ltx_para">
<p class="ltx_p">A <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> controlled <math id="S3.I2.i4.p1.m1" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math>-rotation gate</span> generalizes the CNOT gate.
Let <math id="S3.I2.i4.p1.m2" class="ltx_Math" alttext="U\colon\mathbb{C}^{\oplus 2}\to\mathbb{C}^{\oplus 2}" display="inline"><mrow><mi>U</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup><mo stretchy="false">→</mo><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup></mrow></mrow></math> be a rotation gate,
and let <math id="S3.I2.i4.p1.m3" class="ltx_Math" alttext="H=\mathbb{C}^{\oplus 2}\otimes\mathbb{C}^{\oplus 2}" display="inline"><mrow><mi>H</mi><mo>=</mo><mrow><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup><mo lspace="0.222em" rspace="0.222em">⊗</mo><msup><mi>ℂ</mi><mrow><mo rspace="0em">⊕</mo><mn>2</mn></mrow></msup></mrow></mrow></math> be a <math id="S3.I2.i4.p1.m4" class="ltx_Math" alttext="2" display="inline"><mn>2</mn></math>-qubit space.
Then the controlled <math id="S3.I2.i4.p1.m5" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math> gate has the following circuit diagrams.</p>
<div class="table-container"><table id="Ex23" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<svg id="Ex23.m1.pic1" class="ltx_picture ltx_markedasmath" height="30.61" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex23.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex23.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -11.36 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -11.36 L 11.35 -11.36" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex23.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-25.16,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex23.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(1.44,0) translate(0,-20.24) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.96"><math id="Ex23.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{U}" display="inline"><mi>U</mi></math></foreignObject></g><path class="droprule" d="M 1.44 -11.63 L 20.7 -11.08" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.16 -29.12 L 1.72 -11.36" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.44 -29.39 L 20.7 -28.84" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.42 -29.12 L 20.98 -11.36" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.44 -20.51 L 1.44 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 1.44 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex23.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.7 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.7 -20.51 L 20.7 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">                        </span><svg id="Ex23.m1.pic2" class="ltx_picture ltx_markedasmath" height="30.61" overflow="visible" version="1.1" width="42.89"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex23.m1.pic2.m1" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.38,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex23.m1.pic2.m2" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 10.79 -1.88 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -11.36 L 11.35 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 10.79 -11.36 L 11.35 -11.36" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.38 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex23.m1.pic2.m3" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 12.76 -0.28 L 12.76 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-25.16,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex23.m1.pic2.m4" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(1.44,0) translate(0,-20.24) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.96"><math id="Ex23.m1.pic2.m5" class="ltx_Math" alttext="\textstyle{U}" display="inline"><mi>U</mi></math></foreignObject></g><path class="droprule" d="M 1.44 -11.63 L 20.7 -11.08" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.16 -29.12 L 1.72 -11.36" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.44 -29.39 L 20.7 -28.84" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.42 -29.12 L 20.98 -11.36" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 1.44 -20.51 L 1.44 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 1.44 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="29.19"><math id="Ex23.m1.pic2.m6" class="ltx_Math" alttext="\textstyle{U\ket{\psi}}" display="inline"><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.7 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 20.7 -20.51 L 20.7 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Thus, <math id="S3.I2.i4.p1.m6" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math> is applied when the controlling bit is <math id="S3.I2.i4.p1.m7" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>,
and CNOT is the special case <math id="S3.I2.i4.p1.m8" class="ltx_Math" alttext="U=\sigma_{x}" display="inline"><mrow><mi>U</mi><mo>=</mo><msub><mi>σ</mi><mi>x</mi></msub></mrow></math>. As before,
we get interesting behavior if the control is mixed.</p>
</div>
</li>
</ol>
</div>
</div>
<div id="S3.p7" class="ltx_para">
<p class="ltx_p">And now, some more counterintuitive quantum behavior.
Suppose we try to use CNOT as a copy, with truth table.</p>
<div class="table-container"><table id="Ex24" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex24.m1" class="ltx_Math" alttext="\begin{array}[]{|rr|rr|}\hline\cr\vrule\lx@intercol\hfil\text{In}\hfil%
\lx@intercol\vrule\lx@intercol&amp;\vrule\lx@intercol\hfil\text{Out}\hfil%
\lx@intercol\vrule\lx@intercol\\
\hline\cr 0&amp;0&amp;0&amp;0\\
1&amp;0&amp;1&amp;1\\
0&amp;1&amp;0&amp;1\\
1&amp;1&amp;1&amp;0\\
\hline\cr\end{array}" display="block"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l ltx_border_r" columnspan="2"><mtext>In</mtext></mtd><mtd class="ltx_border_l ltx_border_r" columnspan="2"><mtext>Out</mtext></mtd></mtr><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_b ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">The point of this gate is to be used with a garbage <math id="S3.p7.m1" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> at the bottom
to try and simulate a “copy” operation.
So indeed, one can check that</p>
<div class="table-container"><table id="Ex25" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<svg id="Ex25.m1.pic1" class="ltx_picture ltx_markedasmath" height="42.14" overflow="visible" version="1.1" width="44.22"><g transform="matrix(1 0 0 -1 1.33 14.41) translate(1.33,0)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(-1.33,0) translate(6.92,0) translate(0,-4.73)"><text transform="matrix(1 0 0 -1 0 0)">   </text></g><g transform="translate(5.59,0) translate(0,-10.12) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.96"><math id="Ex25.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{U}" display="inline"><mi>U</mi></math></foreignObject></g><path class="droprule" d="M -1.33 10.68 L 23.47 11.23" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M -1.6 -31.19 L -1.05 10.95" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M -1.33 -31.47 L 23.47 -30.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.19 -31.19 L 23.74 10.95" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M -1.33 -0.28 L -1.33 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -0.28 L 23.47 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(-1.33,0) translate(0,-20.24) translate(6.92,0) translate(0,-4.73)"><text transform="matrix(1 0 0 -1 0 0)">   </text></g><path class="droprule" d="M -1.33 -20.51 L -1.33 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -20.51 L 23.47 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg><span class="ltx_text ltx_font_italic">                        </span><svg id="Ex25.m1.pic2" class="ltx_picture ltx_markedasmath" height="42.14" overflow="visible" version="1.1" width="44.22"><g transform="matrix(1 0 0 -1 1.33 14.41) translate(1.33,0)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic2.m1" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(-1.33,0) translate(6.92,0) translate(0,-4.73)"><text transform="matrix(1 0 0 -1 0 0)">   </text></g><g transform="translate(5.59,0) translate(0,-10.12) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.96"><math id="Ex25.m1.pic2.m3" class="ltx_Math" alttext="\textstyle{U}" display="inline"><mi>U</mi></math></foreignObject></g><path class="droprule" d="M -1.33 10.68 L 23.47 11.23" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M -1.6 -31.19 L -1.05 10.95" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M -1.33 -31.47 L 23.47 -30.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.19 -31.19 L 23.74 10.95" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M -1.33 -0.28 L -1.33 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic2.m4" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -0.28 L 42.89 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -0.28 L 23.47 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-20.24) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic2.m5" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(-1.33,0) translate(0,-20.24) translate(6.92,0) translate(0,-4.73)"><text transform="matrix(1 0 0 -1 0 0)">   </text></g><path class="droprule" d="M -1.33 -20.51 L -1.33 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -20.51 L 0 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(42.89,0) translate(0,-20.24) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex25.m1.pic2.m7" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 42.89 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -20.51 L 42.89 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 23.47 -20.51 L 23.47 -19.96" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Thus we can copy <math id="S3.p7.m2" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math> and <math id="S3.p7.m3" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math>.
But as we’ve already seen if we input <math id="S3.p7.m4" class="ltx_Math" alttext="\ket{\leftarrow}\otimes\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math> into <math id="S3.p7.m5" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math>,
we end up with the entangled state <math id="S3.p7.m6" class="ltx_Math" alttext="\ket{\Psi_{-}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi mathvariant="normal">Ψ</mi><mo>−</mo></msub><mo stretchy="false">⟩</mo></mrow></math>
which is decisively <em class="ltx_emph ltx_font_italic">not</em> the <math id="S3.p7.m7" class="ltx_Math" alttext="\ket{\leftarrow}\otimes\ket{\leftarrow}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow></math> we wanted.
And in fact, the so-called <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> no-cloning theorem</span> implies
that it’s impossible to duplicate an arbitrary <math id="S3.p7.m8" class="ltx_Math" alttext="\ket{\psi}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math>;
the best we can do is copy specific orthogonal states as in the classical case.
See also <a href="#prob:baby_no_clone" title="Problem 24B (Baby no-cloning theorem). ‣ 24.5 A few harder problems to think about ‣ Chapter 24 Quantum circuits ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin" class="ltx_ref"><span class="ltx_text ltx_ref_tag">24B</span></a>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">24.4 </span>Deutsch-Jozsa algorithm</h2>

<div id="S4.p1" class="ltx_para">
<p class="ltx_p">The Deutsch-Jozsa algorithm is the first example of a nontrivial
quantum algorithm which cannot be performed classically:
it is a “proof of concept” that would later inspire Grover’s search algorithm
and Shor’s factoring algorithm.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p class="ltx_p">The problem is as follows: we’re given a function <math id="S4.p2.m1" class="ltx_Math" alttext="f\colon\{0,1\}^{n}\to\{0,1\}" display="inline"><mrow><mi>f</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><mi>n</mi></msup><mo stretchy="false">→</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></mrow></math>,
and promised that the function <math id="S4.p2.m2" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is either</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p class="ltx_p">A constant function, or</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p class="ltx_p">A balanced function, meaning that exactly half the inputs map to
<math id="S4.I1.i2.p1.m1" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> and half the inputs map to <math id="S4.I1.i2.p1.m2" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p">The function <math id="S4.p2.m3" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is given in the form of a reversible black box <math id="S4.p2.m4" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math> which
is the control of a NOT gate, so it can be represented as the circuit diagram</p>
<div class="table-container"><table id="Ex26" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex26.m1.pic1" class="ltx_picture ltx_markedasmath" height="61.9" overflow="visible" version="1.1" width="70.93"><g transform="matrix(1 0 0 -1 0 16.51)"><g transform="translate(-62.65,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="55.73"><math id="Ex26.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{x_{1}x_{2}\dots x_{n}}}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(-9.94,0) translate(0,-4.29) translate(4.15,0)"><foreignObject height="15.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="11.57"><math id="Ex26.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{/^{n}\ignorespaces\ignorespaces\ignorespaces\ignorespaces}" display="inline"><msup><mo>/</mo><mi>n</mi></msup></math></foreignObject></g><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(27.67,0) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><g transform="translate(34.59,0) translate(0,-17.9) translate(0,-2.63)"><foreignObject height="13.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="15.58"><math id="Ex26.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{U_{f}}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math></foreignObject></g><path class="droprule" d="M 27.67 12.78 L 57.09 13.33" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 27.4 -48.84 L 27.95 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 27.67 -49.12 L 57.09 -48.57" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 56.82 -48.84 L 57.37 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 27.67 -0.28 L 27.67 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -0.28 L 27.67 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(70.93,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="55.73"><math id="Ex26.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\ket{x_{1}x_{2}\dots x_{n}}}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 70.93 -0.28 L 70.93 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.09 -0.28 L 70.93 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.09 -0.28 L 57.09 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-35.79) translate(-23.42,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.51"><math id="Ex26.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\ket{y}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>y</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 13.84 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 0 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(27.67,0) translate(0,-35.79) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><path class="droprule" d="M 27.67 -36.07 L 27.67 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -36.07 L 27.67 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(70.93,0) translate(0,-35.79) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="93.79"><math id="Ex26.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{\ket{y+f(x)\mod 2}}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><mrow><mi>y</mi><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>mod</mo><mn>2</mn></mrow><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 70.93 -36.07 L 70.93 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.09 -36.07 L 70.93 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.09 -36.07 L 57.09 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">i.e. if <math id="S4.p2.m5" class="ltx_Math" alttext="f(x_{1},\dots,x_{n})=0" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math> then the gate does nothing,
otherwise the gate flips the <math id="S4.p2.m6" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> bit at the bottom.
The slash with the <math id="S4.p2.m7" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> indicates that the top of the input really consists
of <math id="S4.p2.m8" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> qubits, not just the one qubit drawn,
and so the black box <math id="S4.p2.m9" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math> is a map on <math id="S4.p2.m10" class="ltx_Math" alttext="n+1" display="inline"><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></math> qubits.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p class="ltx_p">The problem is to determine,
with as few calls to the black box <math id="S4.p3.m1" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math> as possible,
whether <math id="S4.p3.m2" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is balanced or constant.</p>
</div>
<div id="S4.Thmtheorem1" class="ltx_theorem ltx_theorem_ques">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Question 24.4.1</span></span>
<br class="ltx_break">
</h5>
<div id="S4.Thmtheorem1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text" style="font-size:90%;">Classically, show that in the worst case we may need
up to <math id="S4.Thmtheorem1.p1.m1" class="ltx_Math" alttext="2^{n-1}+1" display="inline"><mrow><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mn>1</mn></mrow></math> calls to the function <math id="S4.Thmtheorem1.p1.m2" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> to answer the question.</span></p>
</div>
</div>
<div id="S4.p4" class="ltx_para">
<p class="ltx_p">So with only classical tools, it would take <math id="S4.p4.m1" class="ltx_Math" alttext="O(2^{n})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow></mrow></math> queries to determine
whether <math id="S4.p4.m2" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is balanced or constant.
However,</p>
</div>
<div id="S4.Thmtheorem2" class="ltx_theorem ltx_theorem_theorem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);">Theorem 24.4.2</span></span><span class="ltx_text ltx_font_sansserif ltx_font_bold" style="color:var(--latex-color-191970);"> <span class="ltx_text ltx_font_medium">(Deutsch-Jozsa)
<br class="ltx_break"></span></span>
</h5>
<div id="S4.Thmtheorem2.p1" class="ltx_para">
<p class="ltx_p">The Deutsch-Jozsa problem can be determined in a quantum circuit
with only a single call to the black box.</p>
</div>
</div>
<div class="ltx_proof">
<h5 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h5>
<div id="S4.p5" class="ltx_para">
<p class="ltx_p">For concreteness, we do the case <math id="S4.p5.m1" class="ltx_Math" alttext="n=1" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow></math> explicitly;
the general case is contained in <a href="#prob:deutsch_jozsa" title="Problem 24C (Deutsch-Jozsa). ‣ 24.5 A few harder problems to think about ‣ Chapter 24 Quantum circuits ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin" class="ltx_ref"><span class="ltx_text ltx_ref_tag">24C</span></a>.
We claim that the necessary circuit is</p>
<div class="table-container"><table id="Ex27" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex27.m1.pic1" class="ltx_picture ltx_markedasmath" height="61.9" overflow="visible" version="1.1" width="130.01"><g transform="matrix(1 0 0 -1 0 16.51)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex27.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex27.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 13.84 8.6 L 34.77 9.16" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -8.88 L 14.11 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -9.16 L 34.77 -8.6" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.49 -8.88 L 35.04 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.6,0) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><g transform="translate(55.52,0) translate(0,-17.9) translate(0,-2.63)"><foreignObject height="13.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="15.58"><math id="Ex27.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{U_{f}}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math></foreignObject></g><path class="droprule" d="M 48.6 12.78 L 78.02 13.33" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.33 -48.84 L 48.88 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.6 -49.12 L 78.02 -48.57" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 77.75 -48.84 L 78.3 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.6 -0.28 L 48.6 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -0.28 L 48.6 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -0.28 L 34.77 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(91.86,0) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex27.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 91.86 8.6 L 112.79 9.16" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 91.58 -8.88 L 92.14 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 91.86 -9.16 L 112.79 -8.6" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 112.51 -8.88 L 113.07 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 91.86 -0.28 L 91.86 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -0.28 L 91.86 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -0.28 L 78.02 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(126.63,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex27.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 128.04 -1.88 L 128.59 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 128.04 -35.79 L 128.59 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 128.04 -35.79 L 128.59 -35.79" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 126.63 -0.28 L 126.63 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 112.79 -0.28 L 126.63 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 112.79 -0.28 L 112.79 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 126.63 -0.28 L 126.63 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 112.79 -0.28 L 126.63 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 112.79 -0.28 L 112.79 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-35.79) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex27.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-35.79) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex27.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 13.84 -27.19 L 34.77 -26.64" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -44.67 L 14.11 -26.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -44.95 L 34.77 -44.39" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.49 -44.67 L 35.04 -26.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 0 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.6,0) translate(0,-35.79) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><path class="droprule" d="M 48.6 -36.07 L 48.6 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -36.07 L 48.6 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -36.07 L 34.77 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 102.32 -36.07 L 102.32 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -36.07 L 102.32 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -36.07 L 78.02 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Here the <math id="S4.p5.m2" class="ltx_Math" alttext="H" display="inline"><mi>H</mi></math>’s are Hadamard gates,
and the meter at the end of the rightmost wire
indicates that we make a measurement along the usual <math id="S4.p5.m3" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math>, <math id="S4.p5.m4" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math> basis.
This is not a typo! Even though classically the top wire is just
a repeat of the input information,
we are about to see that it’s the top we want to measure.</p>
</div>
<div id="S4.p6" class="ltx_para">
<p class="ltx_p">Note that after the two Hadamard operations, the state we get is</p>
<div class="table-container"><table id="A5.S3.EGx61" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Ex28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex28.m1" class="ltx_Math" alttext="\displaystyle\ket{01}" display="inline"><mrow><mo stretchy="false">|</mo><mn>01</mn><mo stretchy="false">⟩</mo></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex28.m2" class="ltx_Math" alttext="\displaystyle\xmapsto{H^{\otimes 2}}\left(\frac{1}{\sqrt{2}}(\ket{0}+\ket{1})%
\right)\otimes\left(\frac{1}{\sqrt{2}}(\ket{0}-\ket{1})\right)" display="inline"><mrow><mi></mi><mover accent="true"><mo stretchy="false">↦</mo><msup><mi>H</mi><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mn>2</mn></mrow></msup></mover><mrow><mrow><mo>(</mo><mrow><mstyle displaystyle="true"><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.055em">)</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo>(</mo><mrow><mstyle displaystyle="true"><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex29.m1" class="ltx_Math" alttext="\displaystyle=\frac{1}{2}\Big{(}\ket{0}\otimes\big{(}\ket{0}-\ket{1}\big{)}\;+%
\;\ket{1}\otimes\big{(}\ket{0}-\ket{1}\big{)}\Big{)}." display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac linethickness="0.6px"><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>⁢</mo><mrow><mo maxsize="160%" minsize="160%">(</mo><mrow><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo maxsize="120%" minsize="120%">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo maxsize="120%" minsize="120%" rspace="0.280em">)</mo></mrow></mrow><mo rspace="0.502em">+</mo><mrow><mrow><mo stretchy="false">|</mo><mn>1</mn><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo maxsize="120%" minsize="120%">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo maxsize="120%" minsize="120%">)</mo></mrow></mrow></mrow><mo maxsize="160%" minsize="160%">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">So after applying <math id="S4.p6.m1" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math>, we obtain</p>
<div class="table-container"><table id="Ex30" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex30.m1" class="ltx_Math" alttext="\frac{1}{2}\Big{(}\ket{0}\otimes\big{(}\ket{0+f(0)}-\ket{1+f(0)}\big{)}\;+\;%
\ket{1}\otimes\big{(}\ket{0+f(1)}-\ket{1+f(1)}\big{)}\Big{)}" display="block"><mrow><mfrac linethickness="0.6px"><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mo maxsize="160%" minsize="160%">(</mo><mrow><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo maxsize="120%" minsize="120%">(</mo><mrow><mrow><mo stretchy="false">|</mo><mrow><mn>0</mn><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">⟩</mo></mrow></mrow><mo maxsize="120%" minsize="120%" rspace="0.280em">)</mo></mrow></mrow><mo rspace="0.502em">+</mo><mrow><mrow><mo stretchy="false">|</mo><mn>1</mn><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo maxsize="120%" minsize="120%">(</mo><mrow><mrow><mo stretchy="false">|</mo><mrow><mn>0</mn><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">⟩</mo></mrow></mrow><mo maxsize="120%" minsize="120%">)</mo></mrow></mrow></mrow><mo maxsize="160%" minsize="160%">)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">where the modulo <math id="S4.p6.m2" class="ltx_Math" alttext="2" display="inline"><mn>2</mn></math> has been left implicit.
Now, observe that the effect of going from
<math id="S4.p6.m3" class="ltx_Math" alttext="\ket{0}-\ket{1}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></math> to <math id="S4.p6.m4" class="ltx_Math" alttext="\ket{0+f(x)}-\ket{1+f(x)}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mrow><mn>0</mn><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">⟩</mo></mrow></mrow></math> is merely
to either keep the state the same (if <math id="S4.p6.m5" class="ltx_Math" alttext="f(x)=0" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>)
or to negate it (if <math id="S4.p6.m6" class="ltx_Math" alttext="f(x)=1" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>).
So we can simplify and factor to get</p>
<div class="table-container"><table id="Ex31" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex31.m1" class="ltx_Math" alttext="\frac{1}{2}\left((-1)^{f(0)}\ket{0}+(-1)^{f(1)}\ket{1}\right)\otimes\left(\ket%
{0}-\ket{1}\right)." display="block"><mrow><mrow><mrow><mfrac linethickness="0.6px"><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow><mo rspace="0.055em">)</mo></mrow></mrow><mo rspace="0.222em">⊗</mo><mrow><mo>(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Thus, the picture so far is:</p>
<div class="table-container"><table id="Ex32" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex32.m1.pic1" class="ltx_picture ltx_markedasmath" height="61.9" overflow="visible" version="1.1" width="102.32"><g transform="matrix(1 0 0 -1 0 16.51)"><g transform="translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex32.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex32.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 13.84 8.6 L 34.77 9.16" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -8.88 L 14.11 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -9.16 L 34.77 -8.6" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.49 -8.88 L 35.04 8.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.6,0) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><g transform="translate(55.52,0) translate(0,-17.9) translate(0,-2.63)"><foreignObject height="13.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="15.58"><math id="Ex32.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{U_{f}}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math></foreignObject></g><path class="droprule" d="M 48.6 12.78 L 78.02 13.33" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.33 -48.84 L 48.88 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.6 -49.12 L 78.02 -48.57" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 77.75 -48.84 L 78.3 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.6 -0.28 L 48.6 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -0.28 L 48.6 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -0.28 L 34.77 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(102.32,0) translate(6.92,0) translate(0,-5.53)"><foreignObject height="22.14" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="147.98"><math id="Ex32.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\frac{1}{\sqrt{2}}\Big{(}(-1)^{f(0)}\ket{0}+(-1)^{f(1)}\ket{1}\Big{%
)}}" display="inline"><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo maxsize="160%" minsize="160%">(</mo><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>+</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow><mo maxsize="160%" minsize="160%">)</mo></mrow></mrow></math></foreignObject></g><path class="droprule" d="M 102.32 -0.28 L 102.32 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -0.28 L 102.32 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -0.28 L 78.02 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-35.79) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex32.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(0,-35.79) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex32.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 13.84 -27.19 L 34.77 -26.64" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.56 -44.67 L 14.11 -26.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -44.95 L 34.77 -44.39" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.49 -44.67 L 35.04 -26.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 0 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(48.6,0) translate(0,-35.79) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><path class="droprule" d="M 48.6 -36.07 L 48.6 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -36.07 L 48.6 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 34.77 -36.07 L 34.77 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(102.32,0) translate(0,-35.79) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="52.5"><math id="Ex32.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{\frac{1}{\sqrt{2}}(\ket{0}-\ket{1})}" display="inline"><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math></foreignObject></g><path class="droprule" d="M 102.32 -36.07 L 102.32 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -36.07 L 102.32 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.02 -36.07 L 78.02 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">In particular, the resulting state is not entangled,
and we can simply discard the last qubit (!).
Now observe:</p>
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p class="ltx_p">If <math id="S4.I2.i1.p1.m1" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is constant, then the upper-most state is <math id="S4.I2.i1.p1.m2" class="ltx_Math" alttext="\pm\ket{\rightarrow}" display="inline"><mrow><mo>±</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">→</mo><mo stretchy="false">⟩</mo></mrow></mrow></math>.</p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p class="ltx_p">If <math id="S4.I2.i2.p1.m1" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is balanced, then the upper-most state is <math id="S4.I2.i2.p1.m2" class="ltx_Math" alttext="\pm\ket{\leftarrow}" display="inline"><mrow><mo>±</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p">So simply doing a measurement along <math id="S4.p6.m7" class="ltx_Math" alttext="\sigma_{x}" display="inline"><msub><mi>σ</mi><mi>x</mi></msub></math> will give us the answer.
Equivalently, perform another <math id="S4.p6.m8" class="ltx_Math" alttext="H" display="inline"><mi>H</mi></math> gate
(so that <math id="S4.p6.m9" class="ltx_Math" alttext="H\ket{\rightarrow}=\ket{0}" display="inline"><mrow><mrow><mi>H</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">→</mo><mo stretchy="false">⟩</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>, <math id="S4.p6.m10" class="ltx_Math" alttext="H\ket{\leftarrow}=\ket{1}" display="inline"><mrow><mrow><mi>H</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>)
and measuring along <math id="S4.p6.m11" class="ltx_Math" alttext="\sigma_{z}" display="inline"><msub><mi>σ</mi><mi>z</mi></msub></math> in the usual <math id="S4.p6.m12" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math>, <math id="S4.p6.m13" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math> basis.
Thus for <math id="S4.p6.m14" class="ltx_Math" alttext="n=1" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow></math> we only need a single call to the oracle.
<sub title="End of proof">◻︎</sub></p>
</div>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">24.5 </span>A few harder problems to think about</h2>

<div id="Thmproblem1" class="ltx_theorem ltx_theorem_problem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Problem 24A</span></span><span class="ltx_text ltx_font_bold"> </span>(Fredkin gate)<span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="Thmproblem1.p1" class="ltx_para">
<p class="ltx_p">The <span class="ltx_text ltx_font_bold" style="color:var(--latex-color-0000FF);"> Fredkin gate</span> (also called the controlled swap, or CSWAP gate)
is the three-bit gate with the following truth table:</p>
<div class="table-container"><table id="Ex33" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex33.m1" class="ltx_Math" alttext="\begin{array}[]{|rrr|rrr|}\hline\cr\vrule\lx@intercol\hfil\text{In}\hfil%
\lx@intercol\vrule\lx@intercol&amp;\vrule\lx@intercol\hfil\text{Out}\hfil%
\lx@intercol\vrule\lx@intercol\\
\hline\cr 0&amp;0&amp;0&amp;0&amp;0&amp;0\\
0&amp;0&amp;1&amp;0&amp;0&amp;1\\
0&amp;1&amp;0&amp;0&amp;1&amp;0\\
0&amp;1&amp;1&amp;0&amp;1&amp;1\\
1&amp;0&amp;0&amp;1&amp;0&amp;0\\
1&amp;0&amp;1&amp;1&amp;1&amp;0\\
1&amp;1&amp;0&amp;1&amp;0&amp;1\\
1&amp;1&amp;1&amp;1&amp;1&amp;1\\
\hline\cr\end{array}" display="block"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l ltx_border_r" columnspan="3"><mtext>In</mtext></mtd><mtd class="ltx_border_l ltx_border_r" columnspan="3"><mtext>Out</mtext></mtd></mtr><mtr><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd><mtd class="ltx_border_t"></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd></mtr><mtr><mtd class="ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_align_right" columnalign="right"><mn>0</mn></mtd><mtd class="ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr><mtr><mtd class="ltx_border_b ltx_border_l" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b" columnalign="right"><mn>1</mn></mtd><mtd class="ltx_border_b ltx_border_r" columnalign="right"><mn>1</mn></mtd></mtr></mtable></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Thus the gate swaps the last two input bits whenever the first bit is <math id="Thmproblem1.p1.m1" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>.
Show that this gate is also reversible and universal.

One way is to create CCNOT using a few Fredkin gates.


To show the Fredkin gate is universal
it suffices to reversibly create a CCNOT gate with it.
We write the system</p>
<div class="table-container"><table id="A5.S3.EGx62" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Ex34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex34.m1" class="ltx_Math" alttext="\displaystyle(z,\neg z,-)" display="inline"><mrow><mo stretchy="false">(</mo><mi>z</mi><mo>,</mo><mrow><mo rspace="0.167em">¬</mo><mi>z</mi></mrow><mo rspace="0em">,</mo><mo lspace="0em" rspace="0em">−</mo><mo stretchy="false">)</mo></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex34.m2" class="ltx_Math" alttext="\displaystyle=\operatorname{Fred}(z,1,0)" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mi>Fred</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>z</mi><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex35.m1" class="ltx_Math" alttext="\displaystyle(x,a,-)" display="inline"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo rspace="0em">,</mo><mo lspace="0em" rspace="0em">−</mo><mo stretchy="false">)</mo></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex35.m2" class="ltx_Math" alttext="\displaystyle=\operatorname{Fred}(x,1,0)" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mi>Fred</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex36.m1" class="ltx_Math" alttext="\displaystyle(y,b,-)" display="inline"><mrow><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><mi>b</mi><mo rspace="0em">,</mo><mo lspace="0em" rspace="0em">−</mo><mo stretchy="false">)</mo></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex36.m2" class="ltx_Math" alttext="\displaystyle=\operatorname{Fred}(y,a,0)" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mi>Fred</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><mi>a</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex37.m1" class="ltx_Math" alttext="\displaystyle(-,c,-)" display="inline"><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">−</mo><mo>,</mo><mi>c</mi><mo rspace="0em">,</mo><mo lspace="0em" rspace="0em">−</mo><mo stretchy="false">)</mo></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex37.m2" class="ltx_Math" alttext="\displaystyle=\operatorname{Fred}(b,0,1)" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mi>Fred</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ex38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ex38.m1" class="ltx_Math" alttext="\displaystyle(-,d,-)" display="inline"><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">−</mo><mo>,</mo><mi>d</mi><mo rspace="0em">,</mo><mo lspace="0em" rspace="0em">−</mo><mo stretchy="false">)</mo></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ex38.m2" class="ltx_Math" alttext="\displaystyle=\operatorname{Fred}(c,z,\neg z)." display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><mi>Fred</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>c</mi><mo>,</mo><mi>z</mi><mo>,</mo><mrow><mo rspace="0.167em">¬</mo><mi>z</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Direct computation shows that <math id="Thmproblem1.p1.m2" class="ltx_Math" alttext="d=z+xy\pmod{2}" display="inline"><mrow><mi>d</mi><mo>=</mo><mrow><mrow><mi>z</mi><mo>+</mo><mrow><mi>x</mi><mo>⁢</mo><mi>y</mi></mrow></mrow><mspace width="0.949em"></mspace><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0.167em">mod</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</div>
<div id="prob:baby_no_clone" class="ltx_theorem ltx_theorem_problem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Problem 24B</span></span><span class="ltx_text ltx_font_bold"> </span>(Baby no-cloning theorem)<span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="Thmproblem2.p1" class="ltx_para">
<p class="ltx_p">Show that there is no unitary map <math id="Thmproblem2.p1.m1" class="ltx_Math" alttext="U" display="inline"><mi>U</mi></math> on two qubits
which sends <math id="Thmproblem2.p1.m2" class="ltx_Math" alttext="U(\ket{\psi}\otimes\ket{0})=\ket{\psi}\otimes\ket{\psi}" display="inline"><mrow><mrow><mi>U</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></mrow></mrow></math>
for any qubit <math id="Thmproblem2.p1.m3" class="ltx_Math" alttext="\ket{\psi}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math>, i.e. the following circuit diagram is impossible.</p>
<div class="table-container"><table id="Ex39" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex39.m1.pic1" class="ltx_picture ltx_markedasmath" height="57.7" overflow="visible" version="1.1" width="57.78"><g transform="matrix(1 0 0 -1 0 14.41)"><g transform="translate(-25.16,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex39.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.14,0) translate(6.92,0) translate(0,-4.73)"><text transform="matrix(1 0 0 -1 0 0)">   </text></g><g transform="translate(16.06,0) translate(0,-17.9) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.96"><math id="Ex39.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{U}" display="inline"><mi>U</mi></math></foreignObject></g><path class="droprule" d="M 9.14 10.68 L 33.93 11.23" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 8.86 -46.75 L 9.41 10.95" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.14 -47.02 L 33.93 -46.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.65 -46.75 L 34.21 10.95" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.14 -0.28 L 9.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 9.14 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(57.78,0) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex39.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 57.78 -0.28 L 57.78 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.93 -0.28 L 57.78 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.93 -0.28 L 33.93 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-35.79) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex39.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\ket{0}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.14,0) translate(0,-35.79) translate(6.92,0) translate(0,-4.73)"><text transform="matrix(1 0 0 -1 0 0)">   </text></g><path class="droprule" d="M 9.14 -36.07 L 9.14 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 9.14 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 0 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(57.78,0) translate(0,-35.79) translate(6.92,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="18.24"><math id="Ex39.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\ket{\psi}}" display="inline"><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 57.78 -36.07 L 57.78 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.93 -36.07 L 57.78 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.93 -36.07 L 33.93 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Plug in <math id="Thmproblem2.p1.m4" class="ltx_Math" alttext="\ket{\psi}=\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>, <math id="Thmproblem2.p1.m5" class="ltx_Math" alttext="\ket{\psi}=\ket{1}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>, <math id="Thmproblem2.p1.m6" class="ltx_Math" alttext="\ket{\psi}=\ket{\rightarrow}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">→</mo><mo stretchy="false">⟩</mo></mrow></mrow></math>
and derive a contradiction.</p>
</div>
</div>
<div id="prob:deutsch_jozsa" class="ltx_theorem ltx_theorem_problem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Problem 24C</span></span><span class="ltx_text ltx_font_bold"> </span>(Deutsch-Jozsa)<span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="Thmproblem3.p1" class="ltx_para">
<p class="ltx_p">Given the black box <math id="Thmproblem3.p1.m1" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math> described in the Deutsch-Jozsa algorithm,
consider the following circuit.</p>
<div class="table-container"><table id="Ex40" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex40.m1.pic1" class="ltx_picture ltx_markedasmath" height="61.9" overflow="visible" version="1.1" width="165.2"><g transform="matrix(1 0 0 -1 0 16.51)"><g transform="translate(-40.36,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="33.44"><math id="Ex40.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{0\dots 0}}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><mn>0</mn><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mn>0</mn></mrow><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(13.84,0) translate(-9.94,0) translate(0,-4.29) translate(4.15,0)"><foreignObject height="15.51" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="11.57"><math id="Ex40.m1.pic1.m2" class="ltx_Math" alttext="\textstyle{/^{n}\ignorespaces\ignorespaces\ignorespaces\ignorespaces}" display="inline"><msup><mo>/</mo><mi>n</mi></msup></math></foreignObject></g><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(27.67,0) translate(4.15,0) translate(0,-5.86)"><foreignObject height="11.72" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="23.3"><math id="Ex40.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{H^{\otimes n}}" display="inline"><msup><mi>H</mi><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mi>n</mi></mrow></msup></math></foreignObject></g><path class="droprule" d="M 27.67 9.73 L 59.28 10.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 27.4 -10.01 L 27.95 10.01" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 27.67 -10.29 L 59.28 -9.73" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 59 -10.01 L 59.56 10.01" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 27.67 -0.28 L 27.67 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -0.28 L 27.67 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -0.28 L 13.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(73.12,0) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><g transform="translate(80.04,0) translate(0,-17.9) translate(0,-2.63)"><foreignObject height="13.65" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="15.58"><math id="Ex40.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{U_{f}}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math></foreignObject></g><path class="droprule" d="M 73.12 12.78 L 102.54 13.33" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 72.84 -48.84 L 73.39 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 73.12 -49.12 L 102.54 -48.57" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 102.26 -48.84 L 102.82 13.05" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 73.12 -0.28 L 73.12 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 59.28 -0.28 L 73.12 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 59.28 -0.28 L 59.28 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(116.38,0) translate(4.15,0) translate(0,-5.86)"><foreignObject height="11.72" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="23.3"><math id="Ex40.m1.pic1.m6" class="ltx_Math" alttext="\textstyle{H^{\otimes n}}" display="inline"><msup><mi>H</mi><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mi>n</mi></mrow></msup></math></foreignObject></g><path class="droprule" d="M 116.38 9.73 L 147.98 10.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 116.1 -10.01 L 116.65 10.01" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 116.38 -10.29 L 147.98 -9.73" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 147.7 -10.01 L 148.26 10.01" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 116.38 -0.28 L 116.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 102.54 -0.28 L 116.38 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 102.54 -0.28 L 102.54 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(161.82,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex40.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 163.23 -1.88 L 163.79 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 163.23 -35.79 L 163.79 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 163.23 -35.79 L 163.79 -35.79" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 161.82 -0.28 L 161.82 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 147.98 -0.28 L 161.82 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 147.98 -0.28 L 147.98 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 161.82 -0.28 L 161.82 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 147.98 -0.28 L 161.82 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 147.98 -0.28 L 147.98 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-35.79) translate(-23.06,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="16.14"><math id="Ex40.m1.pic1.m8" class="ltx_Math" alttext="\textstyle{\ket{1}}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 13.84 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -36.07 L 0 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(33.01,0) translate(0,-35.79) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="12.63"><math id="Ex40.m1.pic1.m10" class="ltx_Math" alttext="\textstyle{H}" display="inline"><mi>H</mi></math></foreignObject></g><path class="droprule" d="M 33.01 -27.19 L 53.94 -26.64" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 32.74 -44.67 L 33.29 -26.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.01 -44.95 L 53.94 -44.39" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 53.66 -44.67 L 54.22 -26.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 33.01 -36.07 L 33.01 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -36.07 L 33.01 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 13.84 -36.07 L 13.84 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(73.12,0) translate(0,-35.79) translate(6.92,0) translate(0,-2.63)"><text transform="matrix(1 0 0 -1 0 0)">    </text></g><path class="droprule" d="M 73.12 -36.07 L 73.12 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 53.94 -36.07 L 73.12 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 53.94 -36.07 L 53.94 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 132.18 -36.07 L 132.18 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 102.54 -36.07 L 132.18 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 102.54 -36.07 L 102.54 -35.51" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">That is, take <math id="Thmproblem3.p1.m2" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> copies of <math id="Thmproblem3.p1.m3" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math>, apply the Hadamard rotation to all of them,
apply <math id="Thmproblem3.p1.m4" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math>, reverse the Hadamard to all <math id="Thmproblem3.p1.m5" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> input bits
(again discarding the last bit), then measure all <math id="Thmproblem3.p1.m6" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> bits
in the <math id="Thmproblem3.p1.m7" class="ltx_Math" alttext="\ket{0}" display="inline"><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></math>/<math id="Thmproblem3.p1.m8" class="ltx_Math" alttext="\ket{1}" display="inline"><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></math> basis (as in <a href="ch_quantum_states_and_measurements.html#ex:simult_measurement" title="Example 23.4.4 (Simultaneously measuring a general 2-Qubit state) ‣ 23.4 Entanglement ‣ Chapter 23 Quantum states and measurements ‣ Part VII Quantum Algorithms ‣ An Infinitely Large Napkin" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Example</span> <span class="ltx_text ltx_ref_tag">23.4.4</span></a>).</p>
</div>
<div id="Thmproblem3.p2" class="ltx_para">
<p class="ltx_p">Show that the probability of measuring <math id="Thmproblem3.p2.m1" class="ltx_Math" alttext="\ket{0\dots 0}" display="inline"><mrow><mo stretchy="false">|</mo><mrow><mn>0</mn><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mn>0</mn></mrow><mo stretchy="false">⟩</mo></mrow></math>
is <math id="Thmproblem3.p2.m2" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math> if <math id="Thmproblem3.p2.m3" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is constant and <math id="Thmproblem3.p2.m4" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> if <math id="Thmproblem3.p2.m5" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is balanced.

First show that the box sends
<math id="Thmproblem3.p2.m6" class="ltx_Math" alttext="\ket{x_{1}}\otimes\dots\otimes\ket{x_{m}}\otimes\ket{\leftarrow}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mi mathvariant="normal">⋯</mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>m</mi></msub><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow></math>
to <math id="Thmproblem3.p2.m7" class="ltx_Math" alttext="(-1)^{f(x_{1},\dots,x_{m})}(\ket{x_{1}}\otimes\dots\otimes\ket{x_{m}}\otimes%
\ket{\leftarrow})" display="inline"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mi mathvariant="normal">⋯</mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>m</mi></msub><mo rspace="0.055em" stretchy="false">⟩</mo></mrow><mo rspace="0.222em">⊗</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.


Put <math id="Thmproblem3.p2.m8" class="ltx_Math" alttext="\ket{\leftarrow}=\frac{1}{\sqrt{2}}(\ket{0}-\ket{1})" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.
Then we have that <math id="Thmproblem3.p2.m9" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math> sends</p>
<div class="table-container"><table id="Ex41" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex41.m1" class="ltx_Math" alttext="\ket{x_{1}}\dots\ket{x_{m}}\ket{0}-\ket{x_{1}}\dots\ket{x_{m}}\ket{1}\xmapsto{%
U_{f}}\pm\ket{x_{1}}\dots\ket{x_{m}}\ket{0}\mp\ket{x_{1}}\dots\ket{x_{m}}\ket{1}" display="block"><mrow><mrow><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>−</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow><mover accent="true"><mo stretchy="false">↦</mo><msub><mi>U</mi><mi>f</mi></msub></mover><mrow><mrow><mo>±</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow><mo>∓</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">the sign being <math id="Thmproblem3.p2.m10" class="ltx_Math" alttext="+" display="inline"><mo>+</mo></math>, <math id="Thmproblem3.p2.m11" class="ltx_Math" alttext="-" display="inline"><mo>−</mo></math> exactly when <math id="Thmproblem3.p2.m12" class="ltx_Math" alttext="f(x_{1},\dots,x_{m})=1" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>.</p>
</div>
<div id="Thmproblem3.p3" class="ltx_para">
<p class="ltx_p">Now, upon inputting <math id="Thmproblem3.p3.m1" class="ltx_Math" alttext="\ket{0}\dots\ket{0}\ket{1}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>, we find that <math id="Thmproblem3.p3.m2" class="ltx_Math" alttext="H^{\otimes m+1}" display="inline"><msup><mi>H</mi><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></mrow></msup></math> maps it to</p>
<div class="table-container"><table id="Ex42" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex42.m1" class="ltx_Math" alttext="2^{-n/2}\sum_{x_{1},\dots,x_{n}}\ket{x_{1}}\dots\ket{x_{n}}\ket{\leftarrow}." display="block"><mrow><mrow><msup><mn>2</mn><mrow><mo>−</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>⁢</mo><mrow><munder><mo movablelimits="false" rspace="0em">∑</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></munder><mrow><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Then the image under <math id="Thmproblem3.p3.m3" class="ltx_Math" alttext="U_{f}" display="inline"><msub><mi>U</mi><mi>f</mi></msub></math> is</p>
<div class="table-container"><table id="Ex43" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex43.m1" class="ltx_Math" alttext="2^{-n/2}\sum_{x_{1},\dots,x_{n}}(-1)^{f(x_{1},\dots,x_{n})}\ket{x_{1}}\dots%
\ket{x_{n}}\ket{\leftarrow}." display="block"><mrow><mrow><msup><mn>2</mn><mrow><mo>−</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>⁢</mo><mrow><munder><mo movablelimits="false" rspace="0em">∑</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></munder><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mo lspace="0em" rspace="0em" stretchy="false">←</mo><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">We now discard the last qubit, leaving us with</p>
<div class="table-container"><table id="Ex44" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex44.m1" class="ltx_Math" alttext="2^{-n/2}\sum_{x_{1},\dots,x_{n}}(-1)^{f(x_{1},\dots,x_{n})}\ket{x_{1}}\dots%
\ket{x_{n}}." display="block"><mrow><mrow><msup><mn>2</mn><mrow><mo>−</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>⁢</mo><mrow><munder><mo movablelimits="false" rspace="0em">∑</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></munder><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Applying <math id="Thmproblem3.p3.m4" class="ltx_Math" alttext="H^{\otimes m}" display="inline"><msup><mi>H</mi><mrow><mi></mi><mo lspace="0.222em" rspace="0.222em">⊗</mo><mi>m</mi></mrow></msup></math> to this, we get</p>
<div class="table-container"><table id="Ex45" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex45.m1" class="ltx_Math" alttext="2^{-n/2}\sum_{x_{1},\dots,x_{n}}(-1)^{f(x_{1},\dots,x_{n})}\cdot\left(2^{-n/2}%
\sum_{y_{1},\dots,y_{n}}(-1)^{x_{1}y_{1}+\dots+x_{n}y_{n}}\ket{y_{1}}\ket{y_{2%
}}\dots\ket{y_{n}}\right)" display="block"><mrow><msup><mn>2</mn><mrow><mo>−</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>⁢</mo><mrow><munder><mo movablelimits="false" rspace="0em">∑</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></munder><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></msup><mo rspace="0.222em">⋅</mo><mrow><mo>(</mo><mrow><msup><mn>2</mn><mrow><mo>−</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>⁢</mo><mrow><munder><mo movablelimits="false" rspace="0em">∑</mo><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><mo>+</mo><mi mathvariant="normal">⋯</mi><mo>+</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">since <math id="Thmproblem3.p3.m5" class="ltx_Math" alttext="H\ket{0}=\frac{1}{\sqrt{2}}(\ket{0}+\ket{1})" display="inline"><mrow><mrow><mi>H</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>=</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
while <math id="Thmproblem3.p3.m6" class="ltx_Math" alttext="H\ket{1}=\frac{1}{\sqrt{2}}(\ket{0}-\ket{1})" display="inline"><mrow><mrow><mi>H</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo>=</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>−</mo><mrow><mo stretchy="false">|</mo><mn>1</mn><mo stretchy="false">⟩</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>,
so minus signs arise exactly if <math id="Thmproblem3.p3.m7" class="ltx_Math" alttext="x_{i}=1" display="inline"><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow></math> and <math id="Thmproblem3.p3.m8" class="ltx_Math" alttext="y_{i}=1" display="inline"><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow></math> simultaneously,
hence the term <math id="Thmproblem3.p3.m9" class="ltx_Math" alttext="(-1)^{x_{1}y_{1}+\dots+x_{n}y_{n}}" display="inline"><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><mo>+</mo><mi mathvariant="normal">⋯</mi><mo>+</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></mrow></msup></math>.
Swapping the order of summation, we get</p>
<div class="table-container"><table id="Ex46" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex46.m1" class="ltx_Math" alttext="2^{-n}\sum_{y_{1},\dots,y_{n}}C(y_{1},\dots,y_{n})\ket{y_{1}}\ket{y_{2}}\dots%
\ket{y_{n}}" display="block"><mrow><msup><mn>2</mn><mrow><mo>−</mo><mi>n</mi></mrow></msup><mo>⁢</mo><mrow><munder><mo movablelimits="false">∑</mo><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">where <math id="Thmproblem3.p3.m10" class="ltx_Math" alttext="C_{y_{1},\dots,y_{n}}=\sum_{x_{1},\dots,x_{n}}(-1)^{f(x_{1},\dots,x_{n})+x_{1}%
y_{1}+\dots+x_{n}y_{n}}" display="inline"><mrow><msub><mi>C</mi><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></msub><mo rspace="0.111em">=</mo><mrow><msub><mo rspace="0em">∑</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></msub><msup><mrow><mo stretchy="false">(</mo><mrow><mo>−</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>y</mi><mn>1</mn></msub></mrow><mo>+</mo><mi mathvariant="normal">⋯</mi><mo>+</mo><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></mrow></msup></mrow></mrow></math>.
Now, we finally consider two cases.</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p class="ltx_p">If <math id="S5.I1.i1.p1.m1" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is the constant function, then we find that</p>
<div class="table-container"><table id="Ex47" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex47.m1" class="ltx_Math" alttext="C(y_{1},\dots,y_{n})=\begin{cases}\pm 1&amp;y_{1}=\dots=y_{n}=0\\
0&amp;\text{otherwise}.\end{cases}" display="block"><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mo>±</mo><mn>1</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi mathvariant="normal">⋯</mi><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mn>0</mn></mtd><mtd class="ltx_align_left" columnalign="left"><mrow><mtext>otherwise</mtext><mo lspace="0em">.</mo></mrow></mtd></mtr></mtable></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">To see this, note that the result is clear for <math id="S5.I1.i1.p1.m2" class="ltx_Math" alttext="y_{1}=\dots=y_{n}=0" display="inline"><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi mathvariant="normal">⋯</mi><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>0</mn></mrow></math>;
otherwise, if WLOG <math id="S5.I1.i1.p1.m3" class="ltx_Math" alttext="y_{1}=1" display="inline"><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow></math>, then the terms for <math id="S5.I1.i1.p1.m4" class="ltx_Math" alttext="x_{1}=0" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow></math> exactly cancel
the terms for <math id="S5.I1.i1.p1.m5" class="ltx_Math" alttext="x_{1}=1" display="inline"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow></math>, pair by pair.
Thus in this state, the measurements all result in <math id="S5.I1.i1.p1.m6" class="ltx_Math" alttext="\ket{0}\dots\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p class="ltx_p">On the other hand if <math id="S5.I1.i2.p1.m1" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is balanced, we derive that</p>
<div class="table-container"><table id="Ex48" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex48.m1" class="ltx_Math" alttext="C(0,\dots,0)=0." display="block"><mrow><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Thus <em class="ltx_emph ltx_font_italic">no</em> measurements result in <math id="S5.I1.i2.p1.m2" class="ltx_Math" alttext="\ket{0}\dots\ket{0}" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p">In this way, we can tell whether <math id="Thmproblem3.p3.m11" class="ltx_Math" alttext="f" display="inline"><mi>f</mi></math> is balanced or not.</p>
</div>
</div>
<div id="Thmproblem4" class="ltx_theorem ltx_theorem_dproblem">
<h5 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Problem 24D</span></span><span class="ltx_text ltx_font_bold"> </span>(Barenco et al, 1995; arXiv:quant-ph/9503016v1)<span class="ltx_text ltx_font_bold">.</span>
</h5>
<div id="Thmproblem4.p1" class="ltx_para">
<p class="ltx_p">Let</p>
<div class="table-container"><table id="Ex49" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ex49.m1" class="ltx_Math" alttext="P=\begin{bmatrix}1&amp;0\\
0&amp;i\end{bmatrix}\qquad Q=\frac{1}{\sqrt{2}}\begin{bmatrix}1&amp;-i\\
-i&amp;1\end{bmatrix}" display="block"><mrow><mrow><mi>P</mi><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mi>i</mi></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mspace width="2em"></mspace><mrow><mi>Q</mi><mo>=</mo><mrow><mfrac linethickness="0.6px"><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><mn>1</mn></mtd><mtd><mrow><mo>−</mo><mi>i</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>−</mo><mi>i</mi></mrow></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">Verify that the quantum Toffoli gate can be implemented
using just controlled rotations via the circuit</p>
<div class="table-container"><table id="Ex50" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><svg id="Ex50.m1.pic1" class="ltx_picture ltx_markedasmath" height="71.76" overflow="visible" version="1.1" width="154.84"><g transform="matrix(1 0 0 -1 0 4.96)"><g transform="translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex50.m1.pic1.m1" class="ltx_Math" alttext="\textstyle{\ket{x_{1}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><path class="droprule" d="M 19.31 -0.28 L 19.31 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 19.31 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -0.28 L 0 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(46.54,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m3" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 47.96 -1.88 L 48.51 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 47.96 -48.47 L 48.51 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 47.96 -48.47 L 48.51 -48.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 46.54 -0.28 L 46.54 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 19.31 -0.28 L 46.54 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 19.31 -0.28 L 19.31 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(75.4,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m4" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 76.82 -1.88 L 77.37 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 76.82 -15.53 L 77.37 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 76.82 -15.53 L 77.37 -15.53" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 75.4 -0.28 L 75.4 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 49.92 -0.28 L 75.4 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 49.92 -0.28 L 49.92 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(96.33,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m5" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 97.75 -1.88 L 98.3 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 97.75 -22.91 L 98.3 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 97.75 -22.91 L 98.3 -22.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 96.33 -0.28 L 96.33 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.78 -0.28 L 96.33 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 78.78 -0.28 L 78.78 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 120.74 -0.28 L 120.74 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 99.72 -0.28 L 120.74 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 99.72 -0.28 L 99.72 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(141.77,0) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m7" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 143.19 -1.88 L 143.74 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.19 -22.91 L 143.74 -1.88" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.19 -22.91 L 143.74 -22.91" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 141.77 -0.28 L 141.77 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 120.74 -0.28 L 141.77 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 120.74 -0.28 L 120.74 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 154.84 -0.28 L 154.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 145.16 -0.28 L 154.84 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 145.16 -0.28 L 145.16 0.28" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-24.41) translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex50.m1.pic1.m9" class="ltx_Math" alttext="\textstyle{\ket{x_{2}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(17.62,0) translate(0,-24.41) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m10" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 19.03 -26.29 L 19.58 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 19.03 -48.47 L 19.58 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 19.03 -48.47 L 19.58 -48.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 17.62 -24.68 L 17.62 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -24.68 L 17.62 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -24.68 L 0 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.23 -24.68 L 48.23 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21 -24.68 L 48.23 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 21 -24.68 L 21 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(67.54,0) translate(0,-24.41) translate(4.15,0) translate(0,-4.73)"><foreignObject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.81"><math id="Ex50.m1.pic1.m12" class="ltx_Math" alttext="\textstyle{P}" display="inline"><mi>P</mi></math></foreignObject></g><path class="droprule" d="M 67.54 -15.8 L 86.65 -15.25" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 67.26 -33.29 L 67.82 -15.53" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 67.54 -33.56 L 86.65 -33.01" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 86.37 -33.29 L 86.92 -15.53" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 67.54 -24.68 L 67.54 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.23 -24.68 L 67.54 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 48.23 -24.68 L 48.23 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(96.33,0) translate(0,-24.41) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m13" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 97.75 -26.29 L 98.3 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 97.75 -58.69 L 98.3 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 97.75 -58.69 L 98.3 -58.69" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 96.33 -24.68 L 96.33 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 86.65 -24.68 L 96.33 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 86.65 -24.68 L 86.65 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(119.05,0) translate(0,-24.41) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m14" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 120.47 -26.29 L 121.02 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 120.47 -47.12 L 121.02 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 120.47 -47.12 L 121.02 -47.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 119.05 -24.68 L 119.05 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 99.72 -24.68 L 119.05 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 99.72 -24.68 L 99.72 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(141.77,0) translate(0,-24.41) translate(-1.77,0) translate(0,-3.42)"><foreignObject height="6.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.92"><math id="Ex50.m1.pic1.m15" class="ltx_Math" alttext="\textstyle{\bullet}" display="inline"><mo>∙</mo></math></foreignObject></g><path class="droprule" d="M 143.19 -26.29 L 143.74 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.19 -58.69 L 143.74 -26.29" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.19 -58.69 L 143.74 -58.69" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 141.77 -24.68 L 141.77 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 122.44 -24.68 L 141.77 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 122.44 -24.68 L 122.44 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 154.84 -24.68 L 154.84 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 145.16 -24.68 L 154.84 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 145.16 -24.68 L 145.16 -24.13" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(0,-58.69) translate(-27.93,0) translate(0,-3.46)"><foreignObject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="21.01"><math id="Ex50.m1.pic1.m17" class="ltx_Math" alttext="\textstyle{\ket{x_{3}}}" display="inline"><mrow><mo stretchy="false">|</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false">⟩</mo></mrow></math></foreignObject></g><g transform="translate(9.69,0) translate(0,-58.69) translate(4.15,0) translate(0,-3.38)"><foreignObject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.94"><math id="Ex50.m1.pic1.m18" class="ltx_Math" alttext="\textstyle{Q}" display="inline"><mi>Q</mi></math></foreignObject></g><path class="droprule" d="M 9.69 -48.74 L 28.93 -48.19" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.41 -68.92 L 9.96 -48.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.69 -69.19 L 28.93 -68.64" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 28.65 -68.92 L 29.2 -48.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 9.69 -58.97 L 9.69 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -58.97 L 9.69 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 0 -58.97 L 0 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(38.61,0) translate(0,-58.69) translate(4.15,0) translate(0,-3.38)"><foreignObject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.94"><math id="Ex50.m1.pic1.m19" class="ltx_Math" alttext="\textstyle{Q}" display="inline"><mi>Q</mi></math></foreignObject></g><path class="droprule" d="M 38.61 -48.74 L 57.85 -48.19" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 38.34 -68.92 L 38.89 -48.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 38.61 -69.19 L 57.85 -68.64" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.58 -68.92 L 58.13 -48.47" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 38.61 -58.97 L 38.61 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 28.93 -58.97 L 38.61 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 28.93 -58.97 L 28.93 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 77.09 -58.97 L 77.09 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.85 -58.97 L 77.09 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 57.85 -58.97 L 57.85 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 98.02 -58.97 L 98.02 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 77.09 -58.97 L 98.02 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 77.09 -58.97 L 77.09 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><g transform="translate(109.4,0) translate(0,-58.69) translate(4.15,0) translate(0,-4.73)"><foreignObject height="14.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="14.38"><math id="Ex50.m1.pic1.m22" class="ltx_Math" alttext="\textstyle{Q^{\dagger}}" display="inline"><msup><mi>Q</mi><mo>†</mo></msup></math></foreignObject></g><path class="droprule" d="M 109.4 -47.4 L 132.09 -46.85" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 109.12 -70.26 L 109.68 -47.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 109.4 -70.54 L 132.09 -69.98" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 131.81 -70.26 L 132.36 -47.12" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 109.4 -58.97 L 109.4 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 98.02 -58.97 L 109.4 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 98.02 -58.97 L 98.02 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.46 -58.97 L 143.46 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 132.09 -58.97 L 143.46 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 132.09 -58.97 L 132.09 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 154.84 -58.97 L 154.84 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.46 -58.97 L 154.84 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path><path class="droprule" d="M 143.46 -58.97 L 143.46 -58.42" fill="none" stroke="var(--asymptote-color-000000)"></path></g></svg></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table></div>
<p class="ltx_p">This was a big surprise to researchers when discovered,
because classical reversible logic requires three-bit gates (e.g. Toffoli, Fredkind).

This is direct computation.</p>
</div>
</div>
</section>
</section>
</div>
<nav>
<a href="../">Table of Contents</a><br />
<a href="../quantum/quantum-states-and-measurements.html">Previous chapter: Quantum states and measurements</a><br />
<a href="../quantum/shors-algorithm.html">Next chapter: Shor’s algorithm</a>
</nav>

		</main>
	</body>
</html>
